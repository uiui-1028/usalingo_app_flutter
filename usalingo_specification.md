# Usalingo｜Specification Ver.1.0

$$
\color{FF5D97}\rule{400px}{10px}
$$

<aside>
<img src="https://www.notion.so/icons/wheat_gray.svg" alt="https://www.notion.so/icons/wheat_gray.svg" width="40px" />

# *【 usalingo_00_glossary.md 】*

*プロジェクト内で使用される独自の用語や、特に重要な概念の定義を統一するための辞書。*

---

## ***【 usalingo_00_01 ｜Definition of a Term 】***

プロジェクト固有の造語は極力避け、Flutter開発やアジャイル開発の文脈で一般的に使われる業界標準の用語を優先的に採用する。これにより、学習コストの低減と、AIとの円滑で正確なコミュニケーションを図る。不明瞭な用語については、AI側から業界標準の代替案を積極的に提案する。可視性を上げるため, 次のタグクラス（🟢-UIUX, 🟣-Work, 🔵-Cord）を設ける。

```css
.epic {
  タグ: 🟣-Work;
  名前: エピック (Epic);
  説明: "複数のタスクにまたがる、大きな機能開発のまとまり。ユーザーに提供する一つの大きな価値に対応する。Pro usalingo | Workspace データベースで管理する。";
}
.task {
  タグ: 🟣-Work;
  名前: タスク (Task);
  説明: "エピックを達成するために必要な、具体的な作業単位。エンジニアが1〜数日で完了できるサイズ感を基本とする。Pro usalingo | Taskspace データベースで管理する。";
}
.Requirements Definition {
  タグ: 🟣-Work;
  名前: 要件定義書（Requirements Definition）;
  説明: "「このアプリで実現したいこと」「必要な機能」「システムが満たすべき要件」などをまとめた総合文書を指す。本用語は, 仕様書と言い換えを許す";
}
.Document {
  タグ: 🟣-Work;
  名前: ドキュメント (Document);
  説明: "`usalingo_00_xxx.md` のように、特定の責務を持つ最上位のファイル単位。";
}
.Section {
  タグ: 🟣-Work;
  名前: セクション (Section);
  説明: "ドキュメント内で `【 ① ... 】` のように区切られる、機能や関心事のまとまり。";
}
.Item {
  タグ: 🟣-Work;
  名前: 項目 (Item);
  説明: "セクション内で `● ...` のように記述される、個別の仕様や決定事項。";
}
.Table {
  タグ: 🟣-Work;
  名前: 表 (Table);
  説明: "情報を整理して示すために用いるMarkdownの表。ライセンス情報や実現可能性調査などで使用する。データベースの「テーブル」とは区別される。";
}
.AIGC {
  タグ: 🟣-Work;
  名前: AI生成コンテンツ (AI Generative Contents);
  説明: "生成AIが作ったテキストやイラスト，動画などのコンテンツの全てを指す。";
}
.vibe-coding {
  タグ: 🔵-Cord;
  名前: バイブコーディング (Vibe Coding);
  説明: "AIを活用して、自然言語による指示だけでコードを生成・開発する新しいプログラミング手法を指す。";
}
.database {
  タグ: 🔵-Cord;
  名前: DB = データベース（database）;
  説明: "本用語は言い換えを許す";
}
.Directory Structure {
  タグ: 🔵-Cord;
  名前: ディレクトリ構成（= リポジトリ構成）（= ディレクトリツリー）（Directory Structure）;
  説明: "ファイルやフォルダ（＝ディレクトリ）を階層的に整理・配置する仕組みや、その全体像を指する。特にFlutterプロジェクトのファイル構造を指す。本用語は言い換えを許す。";
}
.uiux {
  タグ: 🟢-UIUX;
  名前: uiux = ui/ux = デザイン;
  説明: "本用語は言い換えを許す";
}
.widget {
  タグ: 🟢-UIUX;
  名前: ウィジェット（= UIコンポーネント）(Widget);
  説明: "ユーザーがホーム画面やプロフィール画面に自由に配置・設定できる機能の単位。単語学習デッキ、学習進捗サマリー、ストリーク表示など、アプリ内の各機能は「ウィジェット」として提供される。";
}
.widget-area {
  タグ: 🟢-UIUX;
  名前: ウィジェットエリア (Widget Area);
  説明: "学習タブやプロフィールタブなど、ユーザーがウィジェットを自由に配置・並び替えできる特定のUI領域。";
}
.placeholder {
  タグ: 🟢-UIUX;
  名前: プレースホルダー (Placeholder);
  説明: "ウィジェットエリア内に表示される空きスロット。ユーザーにウィジェットの追加を促す役割を持つ。";
}
```

---

</aside>

$$
\color{FF5D97}\rule{400px}{10px}
$$

<aside>
<img src="https://www.notion.so/icons/wheat_gray.svg" alt="https://www.notion.so/icons/wheat_gray.svg" width="40px" />

# *【 usalingo_01_business_requirements.md 】*

*プロジェクトの「Why」と「How (Business)」を定義する。事業の根幹となる憲法。*

---

## ***【 usalingo_01_01｜Title & Vision & Mission & Background 】***

<aside>

### ● **プロダクト名**

 usalingo - 右脳で覚えるコンセプト単語帳 - 

![logo_white.png](Usalingo%EF%BD%9CSpecification%20Ver%201%200%20242c3d1f59e88126a3a2df4d398ec45c/logo_white.png)

---

### ● **カテゴリ**

パーソナライズ型学習のクロスプラットフォームアプリケーション（ iOS / Android ） & Webアプリ形式（ SaaS ）

---

### ● **ビジョン**

　人類の進歩は知識の獲得と継承に支えられている。しかし現代において、非効率な学習プロセスが個人の成長を阻む障壁となっている。「usalingo」は、この学習の非効率性を解消し、知識の吸収速度を飛躍的に向上させる。人類の知的進歩を加速させ、学習ツールの操作に費やす時間を未来を創造する時間にシフトさせる。

---

### ● **中心思想**

　自分が飽きずに続けられる単語帳が欲しかった。クスッと笑える例文や、つい見てしまうイラストがあれば勉強も少しはマシになる。そんな自分自身が一番のユーザーとして「これならいける」と思えるアプリを、正直に作ること。

---

### ● 開発背景とプロジェクトの原点

　開発者は、APIやデータベースといった基本概念を理解しており、過去1年間、ノーコードツールを用いたWebアプリケーション開発を通じて、要件定義から実装まで全工程を単独で完遂した経験を持つ。この経験から、HTML/CSS/JavaScriptの読解・修正スキルも習得している。

　本プロジェクトの原点は、開発者自身の個人的な学習効率化のために制作したAnkiデッキにある。これまで英語学習に挫折し続けてきた開発者自身が、このデッキによって初めて1900単語を約2ヶ月で記憶に定着させるという、過去にない満足度の高い学習体験を実現した。この個人的な成功体験を元にデッキを試験的に共有したところ、想定を大きく超える反響を得たことで、高品質なコンテンツと五感を刺激する学習体験への強い市場ニーズを確信するに至った。しかし同時に、この成功体験はAnkiというプラットフォームの限界も浮き彫りにした。Ankiは優れたアルゴリズムとコンテンツの自由度を持つ一方で、多くの学習者がそのポテンシャルを最大限に引き出せないUI/UX上の課題を抱えている。

　故に本プロジェクトは、Ankiで実証された学習効果の核を継承しつつ、そのUI/UX上のあらゆる摩擦を解消し、誰にとっても直感的で心地よい学習環境をフルスクラッチで構築する試みである。これは、Flutterという未経験のフレームワークとAIとの協働によって「ひとりユニコーン起業」の達成を目指す、開発者自身の次なる挑戦でもある。

---

### ● **運営母体**

　2024年2月に設立した「合同会社 ImagiCraft」が運営母体となる。以前開発したアプリケーション事業は既に終了しており、現在、同社は代表1名のみの休眠状態にある（2025年7月時点）。本プロジェクトが軌道に乗った段階で、正式に事業として継承する計画である。

---

### **● プロジェクト連絡先**

> **公式アドレス：***taiga@usalingo.jp*
**個人アドレス：***taiyahehe@gmai.com*
> 
</aside>

---

## ***【 usalingo_01_02｜課題 & 解決策 】***

<aside>

### **● 課題（needs）**

多くの学習者が英語学習に挫折する本当の原因は「意志の弱さ」ではない。それは、既存の学習アプリに潜む、ユーザー自身も言語化できない複数の「認知的摩擦」である。これらの摩擦がユーザーの集中力とモチベーションを静かに削り取り、学習継続を困難にしている。結果、ユーザーは「なんとなく面倒だ」と感じ、挫折の原因を「自分の性格や意志のせいだ」と誤って認識してしまう。この「問題のすり替え」こそが、学習者を負のサイクルに閉じ込める根本的な課題である。

1. **視覚的ノイズによる疲弊**
多くのアプリは、学習に不要なボタンや広告、メニューが画面を占有している。ユーザーはこれらの情報を無意識に処理しようとするため、コンテンツに向き合う前に脳が疲弊してしまう。
2. **意思決定の連続による消耗**
学習のたびに「どのデッキを学ぶか？」「評価はどうするか？」といった無数の選択を強いられる。この小さな意思決定の連続が精神的エネルギーを消耗させ、最も重要な「学習する」という行動への障壁となっている。
3. **操作の非直感性による断絶**
カードをめくる、正誤を判定するといった操作が思考のリズムを断ち切る。ユーザーの意図とアプリの反応が一致しないことで学習への没入感が妨げられ、心地よい学習体験が失われている。
4. **心理的プレッシャーによる回避**
過度な目標設定や「連続記録」などの機能は、時に「やらなければ」という義務感に変わり、アプリを開くこと自体を心理的負担にしてしまう。

---

### **● 解決策（solution）**

usalingoは、上記の4つの「認知的摩擦」を徹底的に排除した、**Effortless（努力不要）な学習環境**を提供する。ツールを意識させないほどの透明な存在になることで、ユーザーに「自分のせいではなかった」という成功体験をもたらす。これは単なる学習支援ではなく、学習に対する自信そのものを回復させる体験の提供である。

1. **視覚的ノイズの排除**
学習に必要な情報だけを提示するミニマルなUIを基本とし、ユーザーがウィジェット単位で情報の表示/非表示を完全にコントロールできる**「パーソナライズ・スタディスペース」**を提供する。
2. **意思決定の最小化**
評価は「わかる/わからない」の直感的な二者択一に限定。オンボーディング時の質問に基づき、最適な学習デッキを自動で提案することで、ユーザーを「選ぶ」という負荷から解放する。
3. **直感的で心地よい操作感**
指の動きに物理的に追従するカードスワイプなど、思考を妨げないシームレスなインタラクションを設計。ユーザーが「操作」を意識することなく、学習コンテンツそのものに没入できる環境を実現する。
4. **ポジティブな動機付け**
プレッシャーを与えるのではなく、学習の完了時に得られる瞬間的な達成感や、自分のペースでの継続を祝福するマイクロリワードなど、ポジティブなフィードバックループのみで習慣化を支援する。
</aside>

---

## *【 **usalingo_**01_03｜競争優位性 】*

<aside>

### **● アダプティブ・スペース**

多くのアプリが万人に受ける最大公約数的なデザインを目指す中、usalingoは「個人の集中力を最大化する」という一点に特化する。単なる機能のON/OFFに留まらず、視覚・言語思考といった認知特性レベルでUI/UXを最適化し、ユーザー毎の「脳のクセ」に合わせた学習環境を提供することで、既存アプリでは集中しづらかったユーザー層を強力に引きつける。

- **Notionのブロック思想**
    
    Notionがブロックを自由に組み合わせるように、usalingoは全ての学習機能を「ウィジェット」として提供する。ユーザーはこれらを自由に配置し、自分だけの最適な学習ダッシュボードを構築可能である。
    
- **iOS/Androidのウィジェット思想**
    
    スマートフォンのホーム画面を自分好みに作り上げるように、usalingoの学習タブもウィジェット配置によって自由に編集できる。「自分のための学習空間」として、愛着を持って使えるように設計する。
    
- **Google Chrome の思想**
    
    Chromeがシンプルな初期状態から拡張機能で自分好みにできるように、usalingoもミニマルなUIを基本としつつ、デザインカスタマイズ機能によってテーマや配色などをユーザーの好みに徹底的に合わせることが可能である。
    
- **Spotify/Apple Musicのレコメンド思想**
    
    Spotifyがユーザーの好みを学習して音楽を推薦するように、usalingoは学習履歴から最適な復習タイミングをアルゴリズムが自動で提案し、効率的な学習パスを提供する。
    

---

### **● イマーシブ学習**

学習プロセスそのものを、触覚（Haptics）と視覚（Animation）で心地よい「体験」へと昇華させる。指の動きに物理的に追従するカードスワイプや、正誤判定時の小気味よいアニメーションと振動フィードバックは、学習行為にリズムと楽しさを与える。これは、高機能だがUI/UXに課題を抱えるAnkiやWordHolicのようなアプリにはない明確な優位性であり、操作の摩擦を極限まで減らすことでユーザーの没入感を高める。

---

### **● 学習エコシステム**

学習効果を最大化するため、運営がAIと人手の監修によって「質」と「量」を両立させたコンテンツを提供する。全ての単語には、記憶を助ける高品質なイラストと、Google TTSによる自然な機械音声付きの**標準的な例文**が付属する。これは、高額な課金が必要なMikanやQuizlet、単語学習に特化していないDuolingo、そしてユーザー自身が品質のばらつきや作成の手間を負う必要があるAnkiのUGC（ユーザー生成コンテンツ）とは一線を画す。ユーザーはアプリをダウンロードした瞬間から、信頼できる高品質な教材で、効率的に学習を開始できる。

---

### ● ストーリー例文

学習の基盤として、信頼性の高い標準的な例文を提供するのはもちろんのこと、usalingoの真の強みは、ユーザーが任意で選択できる独自の「体験型コンテンツ」にある。これは単なる例文ではなく、記憶へのフックとなるようエンターテインメント性を重視して創られた、一つ一つのマイクロストーリーである。例えば、「可愛い動物たちの世界」や「ポーカーフェイスな彼女との対話」といったテーマに沿った物語が展開され、その情景を捉えた高品質なイラストと連携することで、単語の意味を忘れられない「体験」として刻み込む。このアプローチは、学習を退屈な作業から魅力的なエンターテイン-メントへと昇華させる。これにより、一般的な例文だけでは到達不可能な、深いユーザーエンゲージメントと強力なブランドロイヤルティを構築する。

</aside>

---

## ***【 usalingo_01_04｜ターゲット & ペルソナ 】***

### **✦ ターゲット**

---

**【メイン】リトライ層**

「今度こそは」という思いで、定期的に学習への意欲が再燃する層。新しいアプリや学習法に希望を見出すが、従来のツールの複雑さや要求の多さによって、無意識のうちにモチベーションが削がれ、いつの間にか離脱してしまった経験を繰り返している。彼らは学習意"欲"が低いのではなく、その意"欲"を維持させてくれる適切な環境に出会えていないだけである。

---

**【サブ】ミニマリスト**

多くの情報や過度な刺激をノイズと感じ、意図的にデジタル環境をシンプルに保つことを好む層。彼らは、スマートフォンの通知を厳選し、使用するアプリも「一つのことを、うまくやる」という哲学を持つものを高く評価する。学習においても、ゲーミフィケーションやSNS的な要素よりも、コンテンツそのものと静かに向き合う、集中した時間を何よりも重視する。

---

### **✦ フェルミ推定｜ユーザー数**

---

*フェルミ推定｜日本市場*

| 階層 | 市場定義 | 算出根拠 | 推定ユーザー数 |
| --- | --- | --- | --- |
| **TAM** | 日本の英語学習者人口 | 日本の成人のうち約3人に1人が何らかの英語学習をしているという調査結果（約4,000万人）を参考に、学生等も含めると少なく見積もっても**約2,000万人**程度が潜在的な市場と仮定。 | 20,000,000人 |
| **SAM** | スマートフォンアプリで英語学習を行う人口 | TAMのうち、スマホアプリを学習手段として利用する層を**30%**と仮定。（2,000万人 × 30%） | 6,000,000人 |
| SOM | `usalingo`が初期に獲得可能なターゲットユーザー数 | SAMのうち、`usalingo`の中核価値（高度なパーソナライズ、高品質なUI/UX、ニッチなコンテンツ）に特に魅力を感じるユーザー層を**5%**と仮定。これは既存アプリに満足していない層や、ペルソナに近い特性を持つユーザーを指する。（600万人 × 5%） | **300,000人** |

---

*フェルミ推定｜海外市場*

| 階層 | 市場定義 | 算出根拠 | 推定ユーザー数 |
| --- | --- | --- | --- |
| **TAM** | 全世界の英語学習者人口 | 全世界の英語学習者数は**約15億人**と推定されている。これは非常に巨大な市場である。 | 1,500,000,000人 |
| **SAM** | スマートフォンアプリで英語学習を行う人口 | TAMのうち、スマートフォンへのアクセスがあり、アプリでの学習が可能な層を**20%**と仮定。（15億人 × 20%） | 300,000,000人 |
| SOM | `usalingo`が初期に獲得可能なターゲットユーザー数 | 海外市場は広大であるが、「ツンデレ彼女」などの独自コンテンツは日本のアニメ・漫画文化に関心を持つ層に特に強く響くと考えられる。この「クールジャパン」に関心を持つ層をSAMの**1%**と仮定し、さらにその中で`usalingo`を選択する層を**1%**と仮定する。（3億人 × 1% × 1%） | **30,000人** |

---

### **✦ ペルソナ**

---

persona-1

```css
名前: コトミさん
年齢: 20代前半・大学生
背景:
・大学の課題やアルバイトで忙しい日々を送る。
・以前から英語学習に興味があり、TOEICスコアアップを目指しているが、従来の単語帳アプリは「いかにも勉強」という感じで長続きしなかった経験がある。
・情報量が多すぎると画面を見ただけで疲れてしまい、ミニマルで洗練されたデザインのアプリを好む。
・暗記は苦手。単語の意味だけでなく、イラストや面白い例文、語源など、ストーリーとして記憶する方が得意。
課題:
・"勉強しなきゃ"というプレッシャーを感じずに、毎日少しでも英語に触れる習慣をつけたい。
・アプリの操作方法を覚えることにストレスを感じたくない。直感的に使えるものがいい。
・学習の成果がひと目でわかるなど、小さな達成感を得てモチベーションを維持したい。
・自分の気分や好みに合わせて、アプリの見た目をカスタマイズできると嬉しい。
```

---

persona-2

```css
名前: タケルくん
年齢: 10代後半・高校生
背景:
・大学受験を控え、毎日大量の英単語を覚える必要に迫られている。
・学校で配布された分厚い単語帳を見るだけでやる気がなくなる。
・スマホゲームが好きで、レベルアップやクリア報酬のような達成感がないと物事が長続きしない。
課題:
・退屈な暗記作業のモチベーションを維持したい。
・ゲーム感覚でサクサク進められる学習ツールが欲しい。
・短時間で効率よく、記憶に残りやすい学習方法を見つけたい。
```

---

persona-3

```css
名前: リナさん
年齢: 30代前半・デザイナー
背景:
・文字だけの情報よりも、ビジュアルやデザインからインスピレーションを得る「視覚思考者」。
・アプリを選ぶ基準は機能性よりも「UIの美しさ」や「心地よい操作感」。
・学習においても、単語に紐づくイラストやイメージが記憶のトリガーになる。
課題:
・テキスト中心の従来の学習方法が頭に入ってこない。
・自分の美意識に合わないツールは使う気になれない。
・学習体験そのものに「わくわく」や「発見」を求めている。
```

---

persona-4

```css
名前: ハルカさん
年齢: 40代・主婦
背景:
・子育てが一段落し、自分の時間が増えた。趣味の海外ドラマを字幕なしで楽しむことを目標に、英語の学び直しを決意。
・学習から長年離れていたため、何から手をつけて良いかわからない。
・複雑な機能や設定は苦手で、シンプルでわかりやすいアプリを求めている。
課題:
・学習を再び習慣化するための、最初のきっかけが欲しい。
・自分のレベルに合った簡単なところから無理なく始めたい。
・日々の小さな成長を感じながら、楽しく学習を続けたい。
```

---

persona-5

```css
名前: ソウタさん
年齢: 20代前半・フリーター
背景:
・注意が散漫になりやすく、多くの情報が一度に目に入ると集中できない特性（ADHD傾向/境界知能）がある。
・アプリの通知や広告、不要なボタンなど、学習以外のノイズに意識を削がれてしまうことが多い。
・自分にとって必要な情報だけを、シンプルな画面で表示させたい。
課題:
・学習の妨げになるあらゆる「ノイズ」を徹底的に排除したい。
・情報の表示/非表示を自分で完全にコントロールしたい。
・認知的な負荷が極限まで低い環境で、一つのことに集中したい。
```

---

## ***【 usalingo_01_05｜ビジネスモデル & 収益計画 】***

<aside>

**● モデル** 

フリーミアムモデルを採用する。公開当初は認知度拡大と開発が不十分である点を考慮し、完全無料のアプリとして提供する。フルスクラッチ開発が軌道に乗り、安定的な運用が見込めるようになった段階で購買モデルへの移行を検討する。デフォルト機能（パーソナライズやウィジェット配置）は全て無料機能として提供する。

---

**● 課金導線の設計思想**

無料で十分に価値を感じてもらうことを最優先とする。登録時にクレジットカードを要求するような心理的ハードルの高いアプローチは避け、機能制限などを通して自然な形でProプランに気づき、価値を感じてから判断してもらうタイミングを設計する。広告モデルは学習の妨げになるため、極力採用しない。Duolingoのように学習後に視聴してもらう形式であれば採用を検討するが、Proモデルではこれを廃止する。

---

**● 課金コンテンツ定義**

| 機能カテゴリー | 無料モデル | プロモデル |
| --- | --- | --- |
| 料金 | 無料 | 月額 ¥300 / 年額 ¥2,000 |
| コンテンツタブ | ニッチコンテンツとAPI 利用ウィジェットを除く全てのコンテンツが利用可能 | API を利用する全てのウィジェットが解放 （AI 例文生成など） |
| デザインタブ | 制限なし | 制限なし |
| データ利用 | コンテンツのダウンロード回数や頻度を制限 | 無料モデルの制限を解放 |
| その他 | 広告あり | 広告なし |

---

**● 収益シミュレーション**

| 項目 | 日本市場 | 備考 |
| --- | --- | --- |
| Pro プラン転換率 (月間) | 0.50% | 初期段階での保守的な仮定 |
| 月間アクティブユーザー (MAU) | 300,000人 | SOM をそのまま MAU と仮定（長期目標値） |
| Pro プラン加入者数 (月間) | 1,500人 | MAU × Pro プラン転換率 |
| 月額 Pro プラン収益 (MRR) | ¥300 × 1,500人 = ¥450,000 | 年額の分散考慮せずシンプル化 |
| 年間収益 (ARR) | ¥5,670,000 | MRR × 12ヶ月 × 成長率 1.05 |

</aside>

---

## *【 usalingo_01_06｜スケーラビリティ 】*

### **● コンテンツの水平展開**

英単語帳の成功モデルを他の学習領域に適用する。具体的には、四字熟語、ことわざ、歴史の年号、法律用語、各種資格試験の暗記事項など、多様なテキストベースの学習コンテンツへとサービスを水平展開していく。これにより、既存の学習システム基盤を最大限に活用し、効率的に新たな顧客層を獲得する。

---

### **● 市場の拡大**

国内市場での基盤確立後は、日本のアニメ・漫画文化に関心の高い層を初期ターゲットとして海外市場への展開を目指す。コンテンツの多言語対応と、各文化圏に合わせたローカライズを視野に入れる。

---

### **● 技術的拡張性**

バックエンドにはSupabaseのようなスケーラブルなBaaSを採用する。これにより、ユーザー数やデータ量の増加に柔軟に対応し、サーバー管理のコストを最小限に抑えながら、グローバルなサービス提供が可能なアーキテクチャを構築する。

---

### **● 運営体制の拡張性**

「ひとりユニコーン」を基本としつつも、事業成長に合わせて運営体制もスケールさせる。コンテンツ制作プロセスの大部分をAIで自動化するほか、将来的には専門領域のコンテンツ監修を外部の専門家（フリーランス等）に委託するなど、固定費を抑えた柔軟な組織体制を維持する。

---

## *【 **usalingo_**01**_**06｜KPI 】*

**● 個人レベルの成功指標**

**自分自身が心の底から『作りたい』と思える理想のプロダクトを、最新の開発手法（バイブコーディング）で最後まで作り上げること。その結果として、プロダクトがユーザーに愛され、事業として自立し、開発者自身もスキルと自信を獲得している状態。**

| 指標 | 目標値 | 評価タイミング |
| --- | --- | --- |
| **Epic_DB の完了率** | **Epic_Ver.1.0 レベルまでの完了率 100%** | **Ver.1.0 リリース直後** |
| **PoC_DB の完了率** | **PoC_Ver.1.0 レベルまでの完了率 100%** | **Ver.1.0 リリース直後** |
| **MAU（初月）** | **1,000人** | **Ver.1.0 リリースから1月後** |
| **ストア評価（1ヶ月後）** | **✦ 4.5以上** | **Ver.1.0 リリースから1月後** |
| **リテンション率** | **20% 以上** | **Ver.1.0 リリースから1月後** |
| **月間収益（MRR）** | **月間収益 ≧ 月間固定費** | **Ver.1.0 リリースから3月後** |

---

**● ビジネス指標**

| 指標名 | 略称 | 目標値 | 説明 |
| --- | --- | --- | --- |
| **月間収益** | MRR | ¥10,000 | フリーミアムモデルにおける事業の健全性を示す最重要指標。有料コンテンツ（学習デッキ等）の月間売上高。 |
| **ユーザー1人あたりの平均収益** | ARPU | ¥1.5 | ユーザーベース全体の収益性を示す。MRR を月間アクティブユーザー数（MAU）で割って算出。 |
| **顧客生涯価値** | LTV | LTV > CPA | 一人のユーザーがアプリの利用を開始してから終了するまでの期間に、usalingo にもたらす総収益の予測値。 |

---

**● プロダクト指標**

| 指標名 | 略称 | 目標値 | 説明 |
| --- | --- | --- | --- |
| **継続率** | Retention | 10% | **PMF（プロダクトマーケットフィット）を測る最重要指標。** ユーザーが定着しているかを示する。（例: Day1, Day7, Day30） |
| **アクティブユーザー数** | DAU/MAU | 20% | アプリが日常的にどれだけ利用されているかを示す指標。プロダクトの健康状態を測る。 |
| **学習ストリーク継続率** | - | 15% | モチベーション設計が機能しているかを測る、usalingo 固有の重要指標。 |
| **有料コンテンツ購入率** | CVR | 0.5% | 無料ユーザーが価値を感じ、有料コンテンツの購入に至った割合。ビジネスモデルの健全性を示す。 |

---

## *【 **usalingo_**01**_**07｜事業リスク & 対策 】*

**● 市場 / 商品リスク**

| リスク | 詳細 | 対策 |
| --- | --- | --- |
| **模倣リスク** | 大手競合が、usalingoの中核価値（ウィジェットUI, 高度なパーソナライズ）を模倣する。 | 対策不要と判断。本質的な優位性は、「特定のユーザー層に深く刺さるニッチなコンテンツ」と「思想」にあるため。仮に表層的な機能が模倣されても、ブランドの世界観やコミュニティの熱量で差別化を図る。 |
| **需要リスク** | そもそも、高度なパーソナライズ機能やミニマリズムなUIUX, ニッチコンテンツを求めるユーザーが想定より少ない。 | ニーズ検証済み。「情報の表示/非表示を自分でコントロールしたい」という、情報の取捨選択にこだわりを持つ層は一定数存在すると想定。 |
| **品質リスク** | AIが生成する単語データ（例文・語源・類義語・画像など）の品質が低く、ユーザーの信頼を損なう。 | `usalingo_02_04` に定める **AIGC ガイドライン**に基づき、コンテンツ品質保証パイプラインを構築・運用する。これにより、AIによる生成から人間による最終監査までの一貫した品質管理プロセスを確立し、不適切なコンテンツの流出を未然に防ぎ、ブランド価値を担保する。 |

---

**● 法務 / 規約リスク**

| リスク | 詳細 | 対策 |
| --- | --- | --- |
| **商標権侵害リスク** | プロダクト名「usalingo」が、既存の商標を侵害する可能性。 | 調査完了。特許情報プラットフォーム（J-PlatPat）にて「usalingo」の商標を検索した結果、類似・重複する登録商標は確認されなかった。（2025年7月30日時点） |
| **プラットフォーム規約違反リスク** | 基本例文に加え, 「ポーカーフェイスな彼女」等の独自コンテンツが、App Store / Google Playのガイドラインに抵触し、リジェクトされる。 | 動的配信システムの構築。問題となりうるコンテンツはアプリ内に直接含めず、Supabaseから配信する。審査で指摘された場合でも、アプリのアップデートなしで該当コンテンツを即座に非表示にできるため、リジェクトリスクを最小限に抑えられる。 |
| **ライセンス違反リスク** | 単語リストの利用条件（クレジット表示等）を遵守せず、ライセンス違反となる。 | クレジット表示の徹底。アプリ内の設定画面などに、ライセンス情報を明記する専用ページを設ける。各ライセンスの要求に基づき、原著作者名やライセンス条文へのリンクを正確に表示することで、規約を遵守する。 |
| 編集著作権侵害リスク | 市販の単語帳（例：「ターゲット1900」など）の単語リストやその配列順をそのまま、あるいは酷似した形で使用した場合、それらの書籍が持つ「編集著作物」としての権利を侵害する可能性。 | NGSLなどライセンスが明確な公開リストをベースにしつつ、独自の基準（例：テーマ、難易度）で単語を追加・削除・再配列することで、オリジナリティのある単語リストを構築する。特定の書籍を参考にする場合でも、単語の選定や配列の独自性を担保する。 |

---

## *【 **usalingo_**01**_**08｜市場・競合分析 】⚠️ 保留*

<aside>

### **● 競合・市場分析のフェーズ定義**

本プロジェクトにおける市場分析は、憶測やバイアスから脱却し、客観的データに基づいた意思決定へと進化させるため、以下の3フェーズで段階的に実行する。

| フェーズ | タイミング | 分析手法 | アウトプット |
| --- | --- | --- | --- |
| **Phase 1: 概念実証** | MVP開発着手前〜開発中 | ・開発者の原体験と課題仮説の言語化
・既存アプリの簡易的な機能比較とSWOT分析 | ・`usalingo_01_04`に定義されたペルソナと課題仮説<br>・主要競合に対する独自の価値提供（Competitive Edge）の言語化 |
| **Phase 2: 仮説検証** | MVPリリース後 | ・Octoparse等を用いた競合アプリのレビューデータや機能アップデート情報の定点観測
・初期ユーザーへのアンケートやヒアリング | ・データに基づいた競合の強み・弱みの再評価<br>・ユーザーの生の声を反映したペルソナの解像度向上<br>・プロダクトバックログの優先順位付け |
| **Phase 3: データ駆動** | 正式リリース後 | ・自社アプリの利用データ分析（アクティブ率、継続率、機能利用率など）<br>・A/BテストによるUI/UXの改善<br>・市場調査レポートや統計データの活用 | ・継続的なプロダクト改善サイクルの確立<br>・データに基づいた新機能の企画・開発<br>・長期的な事業戦略の策定・修正 |

**● 競合分析の要約**

---

**● 競合分析**

- Google Spreadsheet で別途定義中。ある程度に詰まったらこちらに要約して格納する。
- 主要競合アプリ##*⚠️ 表形式にする予定* ##
    - Anki
    - Duolingo
    - Quizlet
    - WordHolic
    - Mikan
    - Vocabrary
    - TAMZAM
    - ターゲット 1900
    - TOEIC-L&R
    - 
</aside>

---

</aside>

$$
\color{FF5D97}\rule{400px}{10px}
$$

<aside>
<img src="https://www.notion.so/icons/wheat_gray.svg" alt="https://www.notion.so/icons/wheat_gray.svg" width="40px" />

# *【 usalingo_02_content_requirements.md 】*

*アプリで扱う「素材」の仕様を定義する。学習コンテンツの設計図。*

---

## ***【** usalingo_02_**01｜学習コンテンツ設計 】***

<aside>

### **✦ 単語の計数方針**

*本アプリでは、学習対象となる単語の数を「**ワードファミリー（Word Family）**」を基準に計測・管理する。*

---

**● ワードファミリーの定義**

ワードファミリーとは、`persist`（動詞）を覚える際に、文法的な変化形（`persists`, `persisted`）だけでなく、派生接辞によって生まれる `persistence`（名詞）や `persistent`（形容詞）なども含めて一つの「語族」として捉えるカウント方法である。

**● 採用理由**

この方法は語彙研究において最も一般的に用いられており、ネイティブスピーカーが接辞のルールから派生語を理解する感覚に近いアプローチである。これにより、例えば「高頻度語3000語」という目標を立てる際も、学術的な基準との一貫性を保つことができる。

---

### **✦ 学習単語ソースの選定**

| **参照リスト名** | 単語数 | 対象 | 参考文献 | タイプ | ライセンス料 | **商用利用可否** | **備考** |
| --- | --- | --- | --- | --- | --- | --- | --- |
| NGSL | 2800 | 基礎 | [https://www.newgeneralservicelist.com/](https://www.newgeneralservicelist.com/new-general-service-list) | オンラインリスト | **無料（CC BY-SA 4.0）** | **可（条件あり）** | クレジット表示＆同ライセンス継承必須 |
| NAWL | 963 | 学術 | [https://www.newgeneralservicelist.com/new-general-service-list-1](https://www.newgeneralservicelist.com/new-general-service-list-1) | オンラインリスト | **無料（CC BY-SA 4.0）** | **可（条件あり）** | クレジット表示＆同ライセンス継承必須 |
| BSL | 1754 | ビジネス | [https://www.newgeneralservicelist.com/business-service-list](https://www.newgeneralservicelist.com/business-service-list) | オンラインリスト | **無料（CC BY-SA 4.0）** | **可（条件あり）** | クレジット表示＆同ライセンス継承必須 |
| TSL | 1200 | TOEIC | [https://www.newgeneralservicelist.com/toeic-service-list](https://www.newgeneralservicelist.com/toeic-service-list) | オンラインリスト | **無料（CC BY-SA 4.0）** | **可（条件あり）** | クレジット表示＆同ライセンス継承必須 |
| Oxford 3000 | 3000 | 日常 | [https://www.oxfordlearnersdictionaries.com/about/wordlists/oxford3000-5000](https://www.oxfordlearnersdictionaries.com/about/wordlists/oxford3000-5000) | オンラインリスト | 有料 | 許可なく不可 | 個別の権利者に事前許諾要 |
| Oxford 5000 | 5000 | 日常 | - | オンラインリスト | 有料 | 許可なく不可 | 個別の権利者に事前許諾要 |
| 鉄壁 | 1981 | 大学受験 |  | 単語帳 | 有料 | 許可なく不可 |  |
| システム英単語 | 2027 | 大学受験 |  | 単語帳 | 有料 | 許可なく不可 |  |
| ターゲット英単語 1000 | 1000 | 大学受験 | - | 単語帳 | 有料 | 許可なく不可 |  |
| ターゲット英単語 1400 | 1400 | 大学受験 | - | 単語帳 | 有料 | 許可なく不可 |  |
| ターゲット英単語 1900 | 1900 | 大学受験 | [https://www.obunsha.co.jp/pr/target/](https://www.obunsha.co.jp/pr/target/) | 単語帳 | 有料 | 許可なく不可 |  |
| 単語王 | 2000 | 大学受験 |  | 単語帳 | 有料 | 許可なく不可 |  |
| 英検準１級 でる順 パス単 | 1900 | 英検 |  | 単語帳 | 有料 | 許可なく不可 |  |
| 速読英単語 必修編 | 1900 | 大学受験 |  | 単語帳 | 有料 | 許可なく不可 |  |
| 速読英単語 上級編 | 1200 | 大学受験 |  | 単語帳 | 有料 | 許可なく不可 |  |
| 出る単特急 銀のフレーズ | 1000 | TOEIC | - | 単語帳 | 有料 | 許可なく不可 |  |
| 出る単特急 金のフレーズ | 1000 | TOEIC |  | 単語帳 | 有料 | 許可なく不可 |  |

---

### **✦ 例文テーマ & 例文イラスト**

*本アプリで提供する学習コンテンツの中核となる、例文のテーマと、それに付随するイラストのビジュアルスタイルを定義する。*

---

### **Thema｜🔰 シンプル系**

---

**✦ 例文サンプル**

特定のテーマといった縛りのない, 一般的な形式。長めの例文と短めの例文でさらに分ける案も検討中。

```yaml
.example-sentence-concern {
  name: "concern";
  english: "This issue concerns everyone.";
  japanese: "この問題は全員に関係する。";
}

.example-sentence-design {
  name: "design";
  english: "She designed the new logo.";
  japanese: "彼女は新しいロゴをデザインした。";
}

.example-sentence-interest {
  name: "interest";
  english: "He has a strong interest in science.";
  japanese: "彼は科学に強い関心を持っている。";
}
```

---

**✦ 例文イラストスタイル**

このテーマのイラストは、Midjourneyのバージョン`--v 6.1`を用いて生成する。ただし、視覚的な多様性を確保するため、スタイル参照（`--sref`）を用いない「基本スタイル」と、「sref管理シート」から承認済みIDをランダムに引用して`--sref`を適用する「参照スタイル」の2種類を意図的に混在させる。全パターンのプロンプトは、GeminiまたはGPTsによる最適化を必須とする。

---

### **Thema｜🙃 ツンデレ系**

- **タイトル候補**
    - 「高嶺の花からの挑戦状」
    - 「ツンデレパートナーと学ぶ英単語」
    - 「ツンデレ彼女のスパルタレッスン」
    - 「ポーカーフェイスな彼女の特別レッスン」
- **例文サンプル**
    
    ```yaml
    .example-sentence-presence {
      name: "presence";
      english: "Your presence is so weak, I forgot you were even here.";
      japanese: "存在感なさすぎて、ここにいるの忘れてたわ。";
    }
    
    .example-sentence-circumstance {
      name: "circumstance";
      english: "Blaming the circumstance again? Classic you.";
      japanese: "また状況のせいにしてるの？いつものあんたね。";
    }
    
    .example-sentence-capability {
      name: "capability";
      english: "I questioned your capability, and now... you've really confirmed it.";
      japanese: "あんたの能力に疑問あったけど、もう確信に変わったよ。";
    }
    
    .example-sentence-attempt {
      name: "attempt";
      english: "That was your best attempt? I'm almost impressed... almost.";
      japanese: "それがあんたの全力の試み？ちょっと...いや、やっぱ無理。";
    }
    
    .example-sentence-responsibility {
      name: "responsibility";
      english: "Taking responsibility means more than just saying 'my bad,' you know.";
      japanese: "責任取るって、「ごめん」で済む話じゃないんだけど？";
    }
    ```
    
- **例文イラストスタイル**
    - このテーマのイラストは、アニメ調の表現に特化したNizijourneyを用いて生成する。ツール自体が持つ独自のスタイルを最大限に活かすため、追加のスタイル参照（`--sref`）は行わない。常に最新バージョン（`--v 6`など）のモデルを使用し、例文の意図を正確に反映させるため、プロンプトはGeminiまたはGPTsを介して最適化する。

---

### **Thema｜🐶 どうぶつ系**

---

今日の主役は、森の動物たち。
ほのぼのとしたストーリーで学ぶ英単語シリーズ。
可愛らしいキャラクターと一緒に、新しい言葉の世界へ出かけよう。

---

```yaml
.example-sentence-technology {
  name: "technology";
  english: "All the forest animals were surprised by the new dam technology Mr. Beaver made!";
  japanese: "森の動物たちは、ビーバーさんが作った新しいダムの技術にみんなびっくり！";
}

.example-sentence-appropriate {
  name: "appropriate";
  english: "Walking quietly is the appropriate action so we don't wake up the hibernating bear.";
  japanese: "冬眠しているクマさんを起こさないように、静かに歩くのが適切な行動だね。";
}

.example-sentence-possible {
  name: "possible";
  english: "If they try hard, it's possible for even small ants to carry a big leaf.";
  japanese: "がんばれば、小さなアリさんでも大きな葉っぱを運ぶことは可能なんだ。";
}

.example-sentence-individual {
  name: "individual";
  english: "The animals in the forest each have their own individual calls, making them very unique.";
  japanese: "森の動物たちは、みんなそれぞれ違う鳴き声を持っていて、とっても個性的だね。";
}

.example-sentence-certain {
  name: "certain";
  english: "Grandpa Owl knows everything about the forest, so his stories are certain to be true.";
  japanese: "フクロウおじいさんは、森のことなら何でも知っているから、彼の話は確かだよ。";
}
```

---

**例文イラストスタイル**

xxx

</aside>

---

## ***【** usalingo_02_**02｜コンテンツ生成フロー 】***

---

### **● テキストコンテンツ生成と品質管理**

```yaml
.property_generation_workflow-summary {
  name: 単語帳プロパティ生成;
  description: "回答出力の一貫性を保つため、Googleスプレッドシート上でのAPI一括生成は行わず、専用のGem/GPTsモジュールを介して各プロパティを丁寧に生成する。";
}

.property_generation_workflow-steps {
  name: プロセスフローと注意点;
  process: "1.【単語リストの準備】対象となる英単語リストを Google-Spreedsheet に用意する。";
  process: "2.【プロパティコンテンツ生成】各単語について、定義済みのプロンプトテンプレートを用いてGem/GPTsモジュールにリクエストを送信し、表形式でプロパティコンテンツを出力する。";
  process: "3.【品質管理】生成された全コンテンツは、後述の `usalingo_02_04｜AIGC ガイドライン` に基づき、自動フィルタリングおよび人間による監査を受ける。";
  process: "4.【csv-エクスポート】承認済みのデータをcsv形式でSupabaseの各テーブルにインポートする。";
  notes: "プロンプトのバージョン管理を徹底し、品質の一貫性を維持する。";
}

.property_generation_workflow-dependencies {
  name: 利用ツール;
  tool: "Google-Spreadsheet";
  tool: "Gemini(Gem) / OpenAI(GPTs)";
  tool: "Notebook-LM";
  tool: "Supabase";
}
```

---

### **● イラストコンテンツ制作と管理**

```yaml
.illustration_generation_workflow-summary {
  name: 例文イラスト生成;
  description: "画像生成AIの精度を向上させ、人間による検品工数を削減するため、生成AIが解釈しやすいプロンプトを生成し、後続の画像処理・DB紐付けまでを自動化するワークフローを採用する。";
}

.illustration_generation_workflow-steps {
  name: プロセスフローと注意点;
  process: "1.【例文の抽出】データベースから、イラストを生成する対象の例文をリストアップする。";
  process: "2.【プロンプトの自動生成】API-Appscriptなどを利用し、例文からMidjourneyが解釈しやすい形式のプロンプトを自動生成する。";
  process: "3.【画像生成】生成されたプロンプトをMidjourney APIで実行し、イラストを生成する。";
  process: "4.【人間による評価】`usalingo_02_04｜AIGC ガイドライン` に基づき、生成されたイラストの中から、例文の意図と最も合致し、かつ品質・安全性の高いものを1点選定する。";
  process: "5.【一次アップロードと自動処理起動】選定した画像をSupabase Storageの一時保管場所にアップロードする。このアップロードをトリガーとして、後続の自動処理を実行する。";
  process: "6.【画像最適化｜Edge Function】Supabase Edge Functionが起動し、アップロードされた画像を自動で処理する。具体的には、WebP形式への**拡張子変換**と、規定サイズ（150KB以下）への**圧縮**を行う。";
  process: "7.【URL紐付けと正規配置】最適化された画像の公開URLを取得し、データベース内の該当する例文レコードにその**URLを自動で紐付ける**。同時に、最適化済みの画像を公開用の正規バケットへ移動させる。";
  process: "8.【後処理】一時保管場所にアップロードされた変換元の画像は、プロセス完了後に自動で削除する。";
  notes: "この自動化ワークフローにより、手作業によるミスをなくし、コンテンツ制作のスケーラビリティを確保する。";
}

.illustration_generation_workflow-specifications {
  name: ファイル仕様と保存場所;
  file-format: WebP;
  resolution: "1280px x 720px (16:9)"//Midjourney のデフォルト出力値;
  max-file-size: "150KB";
  naming-convention: "{word_text}_{illustration_id}.webp";
  storage-bucket: "Supabase Storage (illustrations / Public)";
  folder-structure: "v1/{word_text}/";
}

.illustration_generation_workflow-dependencies {
  name: 利用ツール;
  tool: "Gemini (Gem) / OpenAI (GPTs)";
  tool: "GoAPI（Midjourney）";
  tool: "Supabase Storage";
  tool: "Supabase Edge Functions";
}
```

---

### **● 音声コンテンツの仕様と実装**

---

### **実装ロードマップ**

事業フェーズに応じて、以下の通り段階的に音声機能を進化させる。

- **MVP段階： 静的音声ファイルの同梱**
Ankiアドオンの「AwesomeTTS」などを利用し、サービス提供前に全ての単語・例文の音声ファイル（MP3）を一括で生成する。これらのファイルをアプリパッケージに同梱することで、オフライン環境での安定した音声再生と、API呼び出しコストの完全なゼロ化を実現する。ただし、アプリ容量の増加や、コンテンツ追加時の運用コストが課題となる。
- **Ver.1.x以降： 高品質クラウドTTSの導入（Proプラン向け）**
サービスの収益化に合わせ、より自然で高品質な音声を生成できるクラウドベースのTTS（例: Google Cloud Text-to-Speech, ElevenLabs API）を導入する。これはProプラン限定の機能とし、優れた音声体験を付加価値として提供する。これにより、MVP段階の課題であったアプリ容量の問題を解消し、動的な音声生成も可能になる。

---

### **再生制御とカスタマイズ**

ユーザーが自身の学習スタイルに合わせて挙動を調整できるよう、以下の設定項目を提供する。

- **再生トリガー:**
デフォルトでは、カード表示時に単語や例文が1回だけ自動再生される。
- **リピート機能:**
認知コストを最小限に抑えるため、リピートボタンは初期状態では非表示とする。ユーザーが設定画面で有効化した場合にのみ、カード上に表示されるオプトイン方式を採用する。
- **音声の選択:**
ユーザーは、以下のプリセットされた音声から任意に選択・混合できる。
    - アクセント（例: アメリカ英語 / イギリス英語）
    - 性別（例: 男性 / 女性）
- **再生速度の調整:**
ユーザーは、自身の聞き取りやすさに合わせて再生速度を調整できる（例: 0.75x, 1.0x, 1.25x）。

---

### **技術仕様**

- **データ形式:** 生成する音声ファイルは、圧縮率と音質のバランスに優れるMP3形式で統一する。
- **命名規則:** `word_text`と音声の属性（例: `us_female`）を組み合わせ、一意のファイル名とする。（例: `apple_us_female.mp3`）

---

## ***【** usalingo_02_**03｜チップスコンテンツ定義 】***

*アプリケーションのロード画面などで表示する、短い豆知識（チップス）コンテンツの仕様を定義する。待ち時間を、有益なだけでなく、視覚的にも楽しい「マイクロ体験」へと転換させることを目的とする。*

---

<aside>

### **● コンテンツ構成と表現**

各チップスは、**テキスト情報**とそれを補完する**Lottieアニメーション**のペアで構成される。テキストが持つ意味合い（例: 応援、豆知識、機能紹介）に合わせて、ユーモアのあるものや、分かりやすく概念を表現するものなど、最適なアニメーションを組み合わせる。これにより、ユーザーに情報の理解を促すと同時に、視覚的な楽しさを提供する。

| カテゴリ | 内容例 |
| --- | --- |
| **学習法に関する知識** | 「忘却曲線によると、復習は1日後、3日後、1週間後が効果的である」 |
| **英単語の豆知識** | 「"goodbye"は"God be with ye"（神が汝と共にありますように）が語源なんだよ」 |
| **アプリ機能の紹介** | 「デザインタブから、アプリの色やアイコンを自分好みに変えられます」 |
| **応援メッセージ** | 「1日1単語でも大丈夫。続けることが一番の近道である」 |

---

### **● データ構造と管理**

チップスデータは、更新頻度が低くオフラインでの利用が望ましいため、ローカルDB（SQLite）の`chips_data`テーブルで管理する。

| カラム名 | 型 | 説明 |
| --- | --- | --- |
| chip_id | INTEGER | チップスの一意なID |
| title | TEXT | チップスのタイトル（例：「効果的な復習法」） |
| description | TEXT | チップスの本文 |
| lottie_asset_path | TEXT | アプリ内に同梱されたLottieファイルへのパス
（例: `assets/lottie/tips/forgetting_curve.json`） |
</aside>

---

## ***【** usalingo_02_**04｜AIGC ガイドライン 】***

*本ガイドラインは、usalingoで提供するすべてのAIGC（単語、例文、イラスト等）が、Apple App StoreおよびGoogle Play Storeのポリシーを遵守し、かつusalingoブランドの品質基準を満たすことを保証するために策定された、**コンテンツ生成プロセスの技術的・運用的仕様書**である。コンテンツ生成に関わる全てのプロセス（プロンプト設計、AIによる生成、フィルタリング、人間によるレビュー）は、本ガイドラインを絶対的な基準として運用する。*

---

### ✦ コンテンツ品質管理パイプライン

<aside>

---

### 【フェーズ①】入力制御 (ゲートキーパー)

**目的：** 不適切なコンテンツ生成の可能性を、AIへの指示段階で根絶する。

```
# フェーズ① 入力制御 (ゲートキーパー)
name: "フェーズ① 入力制御"
purpose: "不適切なコンテンツ生成の可能性を、AIへの指示段階で根絶する。"
process_flow:
  - step: 1
    name: "生成要求の受付"
    input: "単語 / テーマ"
    output: "次のプロセスへの入力"

  # --------------------------------------------------------------------

  - step: 2
    name: "プロンプトの構築"
    process: "構造化プロンプトテンプレートを適用"
    details: "役割(Role), 厳格な制約(Constraints), ポジティブな指示(Positive Instruction)をAIへの指示に埋め込む。"
    dependency: "ポリシー準拠フレームワーク"
    output: "安全なAPIリクエストとしてAIモデルへ送信"
```

---

### 【フェーズ②】一次検証 (自動フィルター)

**目的：** AIが生成したコンテンツから、明白な規約違反を機械的に、かつ即座にふるい落とし、大量のコンテンツを高速で分類する。

```
# フェーズ② 一次検証 (自動フィルター)
name: "フェーズ② 一次検証"
purpose: "AIが生成したコンテンツから、明白な規約違反を機械的に、かつ即座にふるい落とし、大量のコンテンツを高速で分類する。"
process_flow:
  - step: 1
    name: "入力受付"
    input: "AIからの生成物 (JSON)"

  # --------------------------------------------------------------------

  - step: 2
    name: "自動検証処理"
    process: "フィルタリング処理 (Supabase Function)"
    details: "テキストデータに対して、以下の検証を自動実行する。"
    dependencies:
      - "NGワードリスト (usalingo_main.pdf)"
      - "有害性判定API (Google Cloud Natural Language API)"

  # --------------------------------------------------------------------

  - step: 3
    name: "出力"
    output: "分類結果: [OK], [要レビュー], [却下]"
```

### ✦ **実装レベル1 (必須): キーワード・フィルタリング**

- **処理内容:** `usalingo_main`スプレッドシート [cite: usalingo_main - Google スプレッドシート.pdf] を基に作成した**NGワードリスト**と生成テキストを照合する。NGワードが一つでも含まれていた場合、その生成結果は自動的に「要レビュー」フラグを立てる。
- **技術仕様:** Supabase Functions内で、生成されたテキストデータに対し、事前に定義した正規表現パターンまたは文字列リストとのマッチング処理を実行する。
- **限界:** この方法は文脈を理解できないため、誤検知（例: `ass`ist）や検知漏れ（隠語など）が発生する可能性がある。そのため、あくまで一次スクリーニングとして位置づける。

### ✦ **実装レベル2 (将来的に推奨): APIによる有害性判定**

- **処理内容:** Google Cloud Natural Language APIの**有害コンテンツ分類**などの外部APIを利用し、生成テキストの有害性（ヘイトスピーチ、性的、暴力的など）をスコアリングする。
- **技術仕様:** 各カテゴリのスコアが事前に設定した閾値を超えた場合、自動的に「却下」または「要レビュー」として分類する。
- **メリット:** 文脈をある程度理解できるため、キーワード・フィルタリングよりも高精度な一次検証が可能となる。

---

### 【フェーズ③】最終承認 (人間による監査)

**目的：** 機械では判断が難しい文脈やニュアンスを人間が判断し、ブランド適合性を含めた最終的な品質を保証する。

```
# フェーズ③ 最終承認 (人間による監査)
name: "フェーズ③ 最終承認"
purpose: "機械では判断が難しい文脈やニュアンスを人間が判断し、ブランド適合性を含めた最終的な品質を保証する。"
process_flow:
  - step: 1
    name: "入力受付"
    input: "「要レビュー」と分類されたコンテンツ"

  # --------------------------------------------------------------------

  - step: 2
    name: "人間による監査"
    process: "レビュワーによる監査"
    details: "定義されたチェックリストに基づき、コンテンツを評価する。"
    dependencies:
      - "レビュー用チェックリスト"
      - "App/Play Store規約"

  # --------------------------------------------------------------------

  - step: 3
    name: "出力"
    output: "判定結果: [承認], [修正], [却下]"

```

### ✦ **レビュワー向けチェックリスト**

自動フィルタリングを通過した、あるいは「要レビュー」と判定されたコンテンツは、人間による最終承認プロセスに回される。レビュワーは以下の項目に基づき、客観的にコンテンツを評価する。

<aside>

- [ ]  **ポリシー準拠:** 「ポリシー準拠フレームワーク」の全カテゴリに抵触する要素は一切ないか？
    - [ ]  性的・冒涜的
    - [ ]  暴力・残虐的
    - [ ]  ヘイト・差別
    - [ ]  違法・危険
    - [ ]  デリケートな事象
- [ ]  **ストア規約準拠:** [Apple App Store Review Guidelines](https://developer.apple.com/app-store/review/guidelines/) [cite: App Review Guidelines.pdf] および [Google Play 不適切なコンテンツポリシー](https://support.google.com/googleplay/android-developer/answer/9878810?hl=ja) [cite: 不適切なコンテンツ - Play Console ヘルプ.pdf] に違反していないか？
- [ ]  **ブランド適合性:** `usalingo`のトーン＆マナー（ポジティブ、学習意欲を削がない）に合致しているか？
- [ ]  **独自コンテンツの文脈:** （例:「ポーカーフェイスな彼女」）キャラクター性が、単なる人格否定や罵倒になっていないか？ユーモアの範囲内か？
- [ ]  **品質:** 誤字脱字、不自然な文法はないか？教育コンテンツとして正確か？
</aside>

### ✦ **判定基準**

- **承認 (Approved):** 全てのチェック項目をクリア。
- **修正 (Edit Required):** 軽微な表現（例: 句読点、単語の選択）の調整で承認基準を満たせるもの。
- **却下 (Rejected):** フレームワークの根本的なルールに違反しており、修正が困難なもの。再生成を指示する。

---

### 【フェーズ④】改善 (フィードバックループ)

**目的：** 本ガイドラインは固定的なものではなく、市場と規約の変化に対応し、品質保証プロセスを継続的に改善する。

```
# フェーズ④ 改善 (フィードバックループ)
name: "フェーズ④ 改善"
purpose: "市場と規約の変化に対応し、品質保証プロセスを継続的に改善する。"
process_flow:
  - step: 1
    name: "情報収集"
    input:
      - "ユーザー報告"
      - "ストアレビュー"
      - "規約変更 / 社会情勢"

  # --------------------------------------------------------------------

  - step: 2
    name: "評価と意思決定"
    process: "定期的レビュー会議 (四半期に一度)"
    details: "収集したフィードバックを基に、ガイドライン全体の見直しを行う。"

  # --------------------------------------------------------------------

  - step: 3
    name: "ガイドラインへの反映"
    output: "更新されたガイドライン"
    details:
      - "プロンプトテンプレートの改善"
      - "NGワードリストの更新"
      - "レビュー基準の精緻化"

```

### ✦ **フィードバック収集**

- アプリ内に**コンテンツの報告機能**を実装し、ユーザーから不適切と思われるコンテンツのフィードバックを収集する。
- App Store / Google Playのレビューや、カスタマーサポートへの問い合わせ内容を定期的に分析する。
</aside>

---

### ✦ 【資料抜選】ポリシー準拠フレームワーク

| カテゴリ | 抵触する可能性のある要素 | 具体的なNG例（単語/テーマ） | ✅ Usalingoでの許容/注意ライン（例文生成時の指針） |
| --- | --- | --- | --- |
| **🚫 1. 性的・冒涜的** | ・露骨な性的描写、ポルノ
・性的満足を目的としたコンテンツ
・ヌードや性的な身体部位の強調
・冒涜的な言葉、卑語 | **単語例:** sex, porn, naked, fuck, breasts, penis 等

**テーマ:** 性行為、売春、性的フェチ、過度な露出 | ・**原則生成禁止。**
・学習対象とする場合も、単語の定義や語源解説に留め、**例文での使用は一切不可**とする。
・hot や sexy 等の多義語は、性的でない文脈でのみ使用を許可する。（例: This coffee is hot.） |
| **🚫 2. 暴力・残虐的** | ・現実的な暴力の描写
・殺人、拷問、虐待、自傷行為
・テロリズム、暴力的過激主義の助長
・兵器の製造や使用の推奨 | **単語例:** blood, corpse, kill, torture, suicide, slaughter 等

**テーマ:** 殺人、戦争、虐待、テロ行為、銃乱射 | ・kill 等の単語は、Kill two birds with one stone. のような**慣用句**や、架空の物語の中など、**現実の暴力を想起させない抽象的な表現に限定**する。
・兵器や犯罪行為を美化・推奨する例文は生成しない。 |
| **🚫 3. ヘイトスピーチ・差別** | ・人種、民族、宗教、国籍、性別、性的指向、障害などに基づく差別、憎悪、暴力の助長
・特定の集団に対する中傷や非人間的な表現 | **単語例:** Nazi, Fascist、各種差別用語

**テーマ:** 特定の集団への偏見、ステレオタイプの助長、陰謀論 | ・**一切生成禁止。例外はない。**
・歴史学習の文脈で扱う場合でも、その行為を中立的または否定的に記述し、決して肯定・美化しない。
・特定の国籍、人種、宗教、性的マイノリティ等を否定的に描写する例文は厳禁。 |
| **🚫 4. 違法行為・危険な活動** | ・規制薬物（マリファナ等）の販売, 助長
・爆発物、銃器の製造方法
・危険なチャレンジ、いじめ、嫌がらせ | **単語例:** 違法薬物の名称、銃器の具体的なモデル名

**テーマ:** 薬物使用の推奨、爆弾の作り方、特定の個人への嫌がらせ | ・**原則として一切生成を禁止する。**
・犯罪を描写する例文は、それがフィクション（例：推理小説の一節）であることが明確で、犯罪行為を推奨するものでない場合に限り、慎重に検討する。 |
| **⚠️ 5. デリケートな事象** | ・災害、紛争、死亡、その他の悲劇的な出来事に対する無神経な言及
・被害者やその関係者を不当に扱うコンテンツ | **テーマ:** 実際に起きた災害、事故、テロ事件、進行中の紛争 | ・実際に起きた悲劇的な出来事を、軽々しく学習例文の題材として利用しない。
・歴史的な出来事として扱う場合も、被害者への配慮を欠いた表現は避ける。 |

---

</aside>

$$
\color{FF5D97}\rule{400px}{10px}
$$

<aside>
<img src="https://www.notion.so/icons/wheat_gray.svg" alt="https://www.notion.so/icons/wheat_gray.svg" width="40px" />

# *【 usalingo_03_design_requirements.md 】*

*プロダクトの「見た目と操作感 (Look and Feel)」を定義する。UI/UXの設計図。*

---

## ***【 usalingo_03_01｜UIUX 基本原則 】***

---

### **● 基本思想 ：『Effortless Learning』**

usalingo の全ての UI/UX では『認知的摩擦』を徹底的に排除した effortless（努力不要）な学習環境を提供する。ユーザーが「ツール」の存在を意識することなく、学習コンテンツそのものに自然と集中できる状態を目指する。

| アプローチ | 中核思想 | 応用方法 |
| --- | --- | --- |
| ミニマリズム | 学習に不要な情報を極限まで絞り込み、UI上のノイズを削減する原則である。 | アプリ起動から学習開始までのタップ回数を最小化し、最短の動線を設計する。また、フラッシュカードの表面には最小限の情報のみを提示し、追加情報はユーザーが必要な時にだけ参照できる設計とする。 |
| 直感性 | ユーザーが意識することなく、自然に操作できるUIを提供する原則である。 | Ankiのような多段階評価ではなく、「わかる／わからない」のシンプルな二者択一を基本とし、判断の迷いをなくす。また、物理法則に基づいたアニメーションや触覚フィードバックにより、操作の結果を予測可能にする。 |
| モバイルファースト | スマートフォン特有の操作性や利用文脈を前提とし、物理的な制約を快適な体験へと昇華させる原則である。 | ・**サムゾーンの考慮**：主要なアクションボタンは、親指で自然にタップできる画面下部エリアに優先的に配置する。
・**タイピングの最小化**：文字入力が必要な場面を極力減らし、選択肢の提示やスワイプ操作で完結させる。
・**プラットフォーム標準の尊重**：アイコンやナビゲーション挙動は各OSの標準ガイドラインに準拠し、ユーザーの学習コストをなくす。
・**割り込みへの配慮**：電話着信などで学習が中断されても進捗が失われないよう、状態を自動保存する。 |
| Bento-UI | 情報をグリッド状のカードに整理し、一覧性とアクセス性を高める思想である。 | 学習タブやプロフィールタブで各機能をウィジェットとして配置する際に採用する。情報を一目で把握でき、タップすれば即座に機能へアクセスできる最短の学習動線を実現する。 |
| Flat Design | 立体感や過度な装飾を排し、本質的な要素とタイポグラフィで情報を伝えるデザイン手法である。 | アプリ全体の基調デザインとして採用する。余計な装飾をなくすことで、ユーザーがコンテンツに集中できる環境を提供する。これはミニマリズムの原則を直接体現する。 |
| Material Design | Googleが提唱する、物理法則に基づいた統一的なデザインシステムである。影や奥行きといった現実世界のメタファーを用いることで、直感的で予測可能な操作性を実現する。 | 一貫性のあるコンポーネント（ボタン、カード等）の設計基盤とし、明確な視覚的フィードバックによって、ユーザーが次に行うべき操作を自然に理解できるよう支援する。 |
| Neumorphism | 背景と同じ色を使い、影とハイライトだけでUI要素の凹凸を表現する、ミニマルで触覚的なデザインである。 | デザインカスタメーションの選択肢の一つとして提供する。ボタンやカードが「押せそう」に見えることで、直感的な意思決定を物理的な感覚でサポートする。 |
| Glassmorphism（Liquid Glass） | すりガラスのような半透明のレイヤーを重ねることで、奥行きと階層構造を軽やかに表現するデザインである。 | モーダルウィンドウやポップアップなど、一時的な表示要素に採用する。背景との関係性を示しつつ、モダンな美的感覚と情報の階層をユーザーに伝える。 |

---

### **● トーンマナー**

| 色名 | カラーコード | 用途 | 説明 |
| --- | --- | --- | --- |
| **アグレッシブピンク** | `#FF5D97` | アクセントカラー | 最も重要なアクションボタンやアクティブな状態を示す際に使用する、ブランドの象徴色。 |
| **ホワイト** | `#FFFFFF` | 背景, テキスト | 主にライトモードの背景色や、ダークモードでのテキスト色として使用する基本色。 |
| **ブラック** | `#393939` | 背景, テキスト | 主にダークモードの背景色や、ライトモードでのテキスト色として使用する基本色。 |

---

### **● ブランドアイデンティティ**

- **コンセプト**: プロダクト名「usalingo」を象徴する「うさぎ - 🐇 」のキャラクターである。ユーザーがフラッシュカードを「ぴょんぴょん」と軽快に楽しく学習できる体験を演出する。
- **役割**: 学習の案内役や、マイクロリワードのアニメーションに登場し、ユーザーを応援・祝福する存在として、無機質になりがちな学習に温かみと楽しさを加える。
    
    ![すくしょ 2025-08-03 21.03.56.png](Usalingo%EF%BD%9CSpecification%20Ver%201%200%20242c3d1f59e88126a3a2df4d398ec45c/%E3%81%99%E3%81%8F%E3%81%97%E3%82%87_2025-08-03_21.03.56.png)
    

---

## ***【 usalingo_03_02｜コンポーネント設計 】***

 *本セクションでは、usalingo を構成する3つの主要タブ（学習、デザイン、プロフィール）それぞれに配置可能な「ウィジェット」の種類と、その機能仕様を定義する。ユーザーはこれらのウィジェットを自由に組み合わせることで、自らの学習スタイルや目的に最適化されたアプリケーション環境を構築する。*

---

### **✦ アトミックコンポーネント｜ガイドライン**

*本セクションでは、UIを構成する最も基本的な原子（Atom）レベルの要素を定義する。これらのコンポーネントは、アプリ全体で一貫したルック＆フィールを保証するための基礎となる。*

---

| コンポーネント | 説明 | 主な使用場面 |
| --- | --- | --- |
| **ボタン** | プライマリアクション（アクセントカラー）、セカンダリアクション（無彩色）など、用途に応じたスタイルを定義。押下状態も考慮する。 | 学習セッションの開始、設定の保存、AI例文の生成、アカウント登録/ログイン |
| **カード** | ウィジェットやフラッシュカードのコンテナ。影、角丸、余白などのスタイルを定義する。 | 学習デッキウィジェットや単語情報を表示するフラッシュカードのコンテナ、設定項目のグループ化 |
| **アイコン** | 機能や状態を視覚的に示すシンボル。原則として、プラットフォーム標準のアイコンセット（iOSではSF Symbols由来のCupertino Icons, AndroidではMaterial Icons）を利用する。これにより、ユーザーがOSレベルで慣れ親しんだ記号で、直感的な操作を促す。 | ウィジェットの編集、設定画面への遷移、メディアコントロール（再生/一時停止）、タブバーの視覚的表現 |
| **タイポグラフィ** | 見出し、本文、キャプションなど、情報の階層に応じたフォントサイズとウェイトを定義する。 | 各画面やセクションの見出し、説明文、カード上の単語や例文、補足情報などのテキスト表示全般 |
| **フォーム部品** | テキスト入力フィールドやスイッチなどのインタラクティブな要素。 | ログイン/サインアップ、アカウント情報編集時のメールアドレスやパスワード入力 |
| テキスト入力フィールド | ラベル、プレースホルダー、ヘルパーテキスト、エラー表示の状態を持つテキスト入力欄。 | ログイン/サインアップ、アカウント情報編集 |
| 選択コントロール | スイッチ（ON/OFF）、ラジオボタン（単一選択）、チェックボックス（複数選択）などの総称。 | 各種設定の切り替え、オンボーディングの選択肢 |
| ドロップダウンメニュー | 複数の選択肢から一つを選択するためのリスト。 | UIテーマやフォントの選択 |
| プログレスインジケーター | 処理中や読み込み中を示す円形（Circular）または線形（Linear）のインジケーター。 | データ読み込み、AI例文生成時の待機表示 |
| ダイアログ / モーダル | ユーザーに確認を求めたり、追加情報を提示したりするためのポップアップウィンドウ。 | アカウント登録の促進、各種設定の詳細表示 |
| スナックバー / トースト | 操作の完了や軽微なエラーなどを、画面下部等に一時的に表示して通知する要素。 | 「設定を保存しました」などのフィードバック |
| チップ | 選択、フィルタリング、短い情報の表示などに使うコンパクトなラベル要素。 | 学習デッキのタグ表示、品詞の表示 |
| スライダー | 特定の範囲から一つの値を直感的に選択するためのコントロール。 | 音声の再生速度、フォントサイズの調整 |
| タブ | 関連するコンテンツをグループ分けし、切り替えて表示するためのナビゲーション要素。 | メイン画面のボトムナビゲーション |
| 区切り線 (Divider) | リストやコンテンツのセクション間を視覚的に分割するための線。 | 設定項目やリストアイテムの境界 |

---

### **✦ 学習タブ**

 *日々の学習を行うための、インタラクティブなウィジェットを配置するエリア。ユーザーはここに学習したいテーマのデッキを配置し、アプリ起動後すぐに学習を開始できる。*

---

<aside>

**● 学習デッキウィジェット (Learning Deck Widget)**

 *Ankiのデッキ思想を基盤とした、usalingo の中核となる学習ウィジェット。新規カードの学習から忘却曲線に基づいた復習まで、全ての学習活動をこのウィジェット内で完結させる。*

```yaml
.widget-learning_deck {
  name: "学習デッキウィジェット"
  description: "新規・復習カードを統合管理する、単語学習のコア機能。ユーザーはデッキごとに学習方法や範囲を柔軟に設定できる。";
  
  core_interaction:
    - name: "即時学習スタート"
      trigger: ウィジェット本体のタップ。"
      action: 最後に保存された設定で、即座に学習セッションを開始する。"
      
    - name: "学習設定の編集"
      trigger: ウィジェット内の編集アイコンをタップ。"
      action: 学習設定用のボトムシートが開き、セッション内容をいつでも手軽に変更できる。"
      
  customizable_options:
    - name: "学習スタイル"
      description: 単語の定着度や気分に合わせて学習形式を選択できる。"
      options:
        - フラッシュカード形式（スワイプ＆パンチ）"
        - 4択クイズ形式"
        - 単語合わせゲーム形式"
        
    - name: "出題範囲設定"
      description: 学習する単語の範囲を柔軟に設定できる。"
      options:
        - デッキ全体（例：1000単語全てからランダム出題）"
        - 章ごと（例：1〜100, 101〜200のように範囲を限定）"
        
    - name: "セッション設定"
      description: 一度の学習におけるカード枚数や順番をコントロールできる。"
      options:
        - 1セットあたりのカード枚数設定"
        - 出題順（ランダム / 登録順）"
}
```

```yaml
.widget-learning_deck {
  name: "学習デッキウィジェット"
  description: "新規・復習カードを統合管理する、単語学習のコア機能。ユーザーはデッキごとに学習方法や範囲を柔軟に設定できる。";
  
  core_interaction:
    - name: "即時学習スタート"
      trigger: ウィジェット本体のタップ。"
      action: 最後に保存された設定で、即座に学習セッションを開始する。"
      
    - name: "学習設定の編集"
      trigger: ウィジェット内の編集アイコンをタップ。"
      action: 学習設定用のボトムシートが開き、セッション内容をいつでも手軽に変更できる。"
      
  customizable_options:
    - name: "学習スタイル"
      description: 単語の定着度や気分に合わせて学習形式を選択できる。"
      options:
        - フラッシュカード形式（スワイプ＆パンチ）"
        - 4択クイズ形式"
        - 単語合わせゲーム形式"
        
    - name: "出題範囲設定"
      description: 学習する単語の範囲を柔軟に設定できる。"
      options:
        - デッキ全体（例：1000単語全てからランダム出題）"
        - 章ごと（例：1〜100, 101〜200のように範囲を限定）"
        
    - name: "セッション設定"
      description: 一度の学習におけるカード枚数や順番をコントロールできる。"
      options:
        - 1セットあたりのカード枚数設定"
        - 出題順（ランダム / 登録順）"
}
```

---

**● 単語帳プロパティ｜カード配置要件**

*各単語に紐づくデータ項目（品詞、例文、日本語訳、語源、類義語、対義語、画像URL等）を定義する。これらの情報は、ユーザーがフロントエンド側で表示/非表示を自由に切り替えられる対象となる。*

| プロパティ | 日本語 | 型 | 例 | 表面配置 | 裏面配置 | パーソナライズ |
| --- | --- | --- | --- | --- | --- | --- |
| word | 英単語 | text | responsibility | ◯ | ◯ | 必須／対象 |
| definition | 訳-単語 | text | 責任、責務 | × | ◯ | 必須／対象 |
| sentence | 例文 | text | Taking responsibility means more than just saying 'my bad,' you know. | ◯ | ◯ | 選択／対象 |
| sentence-define | 訳-例文 | text | 責任取るって、「ごめん」で済む話じゃないんだけど？ | × | ◯ | 選択／対象 |
| part-of-speech | 品詞 | text | ラテン語の "respondere"（応答する）に由来し、「応答する義務」が原義。 | ◯ | ◯ | 選択／対象 |
| etymology | 語源 | text | 古英語の "æppel" に由来。 | × | ◯ | 選択／対象 |
| synonyms | 類義語 | text | duty, accountability, obligation | × | ◯ | 選択／対象 |
| antonyms | 対義語 | text | irresponsibility | × | ◯ | 選択／対象 |
| illustration | 例文イラスト | url | https://xxx | ◯ | ◯ | 選択／対象 |

---

**● AI 例文生成・読解ウィジェット (Pro Widget)**

 *学習デッキウィジェットで学習した単語を利用し、ユーザーの好みのテーマで 文章生成 AI が API 経由で動的に例文を生成する応用的な学習ウィジェット。英文と日本語訳が交互に連なった構成で, 中央線より上に超えると透明な日本語訳が表示される仕組みである。*

```yaml
.widget-ai_sentence_generator {
  name: AI 例文生成・読解ウィジェット;
  description: ユーザーの学習履歴からランダムに選ばれた複数の単語を使い、AIがリアルタイムにユニークな例文を生成する機能。復習の新しい形を提供する。;
  
  core_interaction:
    - name: 例文の新規生成
      trigger: ウィジェット内の生成ボタンをタップ。
      action: ユーザーの学習進捗データに基づき、復習対象となる単語を複数抽出し、それらを文脈に含んだ例文をAIが生成。完了後、カード形式で結果を表示する。
  
  customizable_options:
    - name: 文脈テーマ（任意）
      description: 例文の文脈（例: ビジネス、日常会話）を指定することで、より具体的なシーンでの復習が可能になる。
      options:
        - プリセットされたタグ選択
}
```

---

</aside>

---

### **✦ デザインカスタマイズタブ**

 *アプリ全体のUI/UX（見た目、操作感、フィードバック）をユーザーの好みに合わせて調整するための設定項目群を配置するエリア。これらはウィジェットではなく、タブ内に直接配置される設定モジュール。*

---

<aside>

**● UIテーマ設定モジュール**

 *アプリ全体のデザインシステム、カラーモード、アクセントカラーを包括的に変更する。*

```yaml
.module-ui_theme {
  name: UIテーマ設定モジュール;
  description: アプリ全体のルック＆フィールを、ユーザーの美的感覚に合わせて根本から調整する。;
  customizable_options:
    ------------------------------------
    - name: デザインスタイル
      description: アプリのUIデザインの基本スタイルを選択する。
      options:
        - FlatDesign（デフォルト）
        - Neumorphism
        - Glassmorphism
        - MaterialDesign
    ------------------------------------
    - name: カラーモード
      description: 表示モードを切り替える。
      options:
        - ライトモード
        - ダークモード
        - システム設定に追従（デフォルト）
    ------------------------------------
    - name: アクセントカラー
      description: ボタンやアクティブな要素に使われる差し色を、運営が用意したカラーパレットから選択する。
      options:
        - ピンク（デフォルト）
        - プリセットカラー
}
```

---

**● カードUI設定モジュール**

 *学習カードに表示する情報（語源、イラスト等）の ON/OFF や、操作モード（パンチ / 裏返し）を切り替える。*

```yaml
.module-card_ui {
  name: カードUI設定モジュール;
  description: 学習カードの表示要素や操作方法をカスタマイズし、個々のユーザーにとって最も集中しやすい情報レイアウトを実現する。;
  customizable_options:
    ------------------------------------
    - name: 情報表示設定
      description: カード上に表示するデータ項目をON/OFFで切り替える。
      options:
        - 単語訳
        - 単語音声
        - 発音記号
        - 例文
        - 例文訳
        - 例文音声
        - 品詞
        - 語源
        - 類義語
        - 対義語
        - イラスト
    ------------------------------------
    - name: 解答インタラクション
      description: 解答を表示する際の操作方法を選択する。
      options:
        - パンチアクション（タップで表示）
        - カード裏返し（スワイプまたはタップで反転）
}
```

---

**● アプリ挙動設定モジュール**

 *フォント、読み上げ音声（TTS）、効果音、振動フィードバックなど、UI以外の体験をカスタマイズする。*

```yaml
.module-app_behavior {
  name: アプリ挙動設定モジュール;
  description: 視覚以外の感覚フィードバックを調整し、より心地よい学習体験を創出する。;
  customizable_options:
    ------------------------------------
    - name: フォント
      description: アプリ全体の表示フォントを選択する。主にGoogle Fontsから提供されるが、個別のカスタムフォントも追加予定である。
      options:
        - システム標準フォント
        - Google Fontsシリーズ（複数）
        - カスタムフォント（随時追加）
    ------------------------------------
    - name: 読み上げ音声（TTS）
      description: 単語や例文を読み上げる音声の種類を選択する。
      options:
        - 複数のプリセット音声（性別、話速など）
    ------------------------------------
    - name: 効果音と振動
      description: 操作時のサウンドエフェクトや、触覚フィードバック（Haptics）のON/OFFを切り替える。
      options:
        - ON/OFFスイッチ
}
```

---

**● アプリアイコン変更モジュール**

 *スマートフォンのホーム画面に表示されるアプリアイコンを、複数のデザインから選択できる。*

```yaml
.module-app_icon {
  name: アプリアイコン変更モジュール;
  description: ホーム画面のアイコンをカスタマイズすることで、アプリへの愛着を深める。;
  customizable_options:
    - name: アイコン選択
      description: ロゴと背景の色を組み合わせたアイコンデザインの中から、好みのものを選択して適用する。
      options:
        - ホワイト背景 x ピンクロゴ
        - ホワイト背景 x ブラックロゴ
        - ピンク背景 x ホワイトロゴ
        - ブラック背景 x ホワイトロゴ
        - ブラック背景 x ピンクロゴ
}
```

</aside>

---

### **✦ プロフィールタブ**

 *学習の記録や成果を可視化し、アカウント管理機能へアクセスするためのデータウィジェットを配置するエリア。ユーザーはこれらのウィジェットを自由に配置し、自分に必要な情報をまとめたダッシュボードを構築する。*

---

<aside>

**● ストリークウィジェット**

 *連続学習記録を表示し、日々の学習継続を視覚的にサポートする。*

```yaml
.widget-streak {
  name: ストリークウィジェット;
  description: 学習の継続を視覚的に伝え、習慣化をサポートする最重要ウィジェット。1日1単語でも学習すればストリークは継続される。;
  core_interaction:
    - name: 詳細表示
      trigger: ウィジェット本体のタップ。
      action: ストリークの定義や、過去の継続記録などの詳細情報を表示するモーダルを開く。
  display_elements:
    - 現在の連続学習日数
    - 自己最長記録
    - 継続日数に応じたLottieアニメーション（例: うさぎキャラクターが喜ぶ）
  reference: 【 02_05｜UXデザイン 】
}
```

---

**● 学習ヒートマップウィジェット**

 *GitHubのコントリビューショングラフのように、学習した日を色の濃淡で可視化する。*

```yaml
.widget-heatmap {
  name: 学習ヒートマップウィジェット;
  description: 日々の学習量を直感的に振り返ることができる。タップした日付の学習単語数などの詳細データも確認可能。;
  core_interaction:
    - name: 日付ごとの詳細確認
      trigger: ヒートマップ上の各マスをタップ。
      action: 選択した日付の学習時間や学習単語数などの簡易サマリーをポップアップで表示する。
  display_elements:
    - 過去365日分の学習アクティビティグリッド
    - 学習量に応じた色の濃淡（例: 0単語=白, 1-10単語=薄い緑, 11-30単語=緑...）
}
```

---

**● 実績サマリーウィジェット**

 *総学習単語数、総学習時間、正解率など、累計の学習データを表示する。*

```yaml
.widget-stats_summary {
  name: 実績サマリーウィジェット;
  description: 総学習単語数や総学習時間など、累計の学習データを集約して表示する。;
  display_elements:
    - 総学習単語数
    - マスター済み単語数
    - 総学習時間（概算）
    - 生涯正解率
}
```

---

**● 簡易プロフィールウィジェット**

 *ユーザーの名前と現在のプランを表示するウィジェット。タップすることで、メールアドレスやパスワード、プランの変更など、ユーザー固有のアカウント設定画面へ遷移する。*

```yaml
.widget-user_profile {
  name: 簡易プロフィールウィジェット;
  description: ユーザー名と現在のプラン情報を表示する。タップで詳細なアカウント設定画面へ遷移する。;
  core_interaction:
    - name: アカウント設定画面へ遷移
      trigger: ウィジェット本体のタップ。
      action: メールアドレスやパスワードの変更、プランの確認・変更を行うアカウント設定ページへナビゲートする。
  display_elements:
    - ユーザー名 or ニックネーム
    - 現在の利用プラン（例: Free / Pro）
}
```

---

**● アプリロゴウィジェット**

 *usalingo のブランドロゴを配置するウィジェット。ロゴとしてのデザイン性を保ちつつ、タップすることでプランのアップグレード、利用規約、ヘルプセンターといった、アプリの補助的な機能へアクセスするための入り口として機能する。*

```yaml
.widget-app_logo {
  name: "アプリロゴウィジェット";
  description: "機能性とデザイン性を両立させた、補助機能へのナビゲーションハブ。使用頻度の低い設定や法務関連情報への入り口を集約し、主要画面のUIをシンプルに保つ。";
  
  core_interaction:
    - name: "補助機能メニューの表示"
      trigger: "ウィジェット本体をタップする。"
      action: "後述の`menu_items`で定義された項目リストを、ボトムシートまたはモーダル形式で表示する。";
      
  display_elements:
    - "usalingoのロゴ";

  menu_items: [
    {
      name: "プラン詳細・アップグレード",
      description: "現在のプラン内容の確認と、Proプランへのアップグレード画面へ遷移する。",
      priority: "P1 (高)"
    },
    {
      name: "ヘルプセンター / FAQ",
      description: "アプリの使い方やよくある質問をまとめたページを表示する。",
      priority: "P2 (中)"
    },
    {
      name: "利用規約",
      description: "アプリの利用条件を定めた法的なドキュメントを表示する。",
      priority: "P2 (中)"
    },
    {
      name: "プライバシーポリシー",
      description: "ユーザーデータの取り扱い方針を定めた法的なドキュメントを表示する。",
      priority: "P2 (中)"
    },
    {
      name: "ライセンス情報",
      description: "アプリ内で使用している外部アセットやライブラリのライセンス情報を表示する。",
      priority: "P3 (低)"
    },
    {
      name: "お問い合わせ",
      description: "運営への問い合わせフォームやメールアドレスへの導線を提供する。",
      priority: "P3 (低)"
    },
    {
      name: "バージョン情報",
      description: "現在のアプリケーションのバージョン番号を表示する。",
      priority: "P4 (最低)"
    }
  ]
}
```

</aside>

---

## ***【 usalingo_03_03｜インタラクション & フィードバック設計 】***

*ユーザーに学習以外の行動（目標設定、アイテム収集など）を一切求めない。学習プロセスの中に溶け込んだ、シンプルで瞬間的なフィードバックループを構築し、認知コストを極限まで下げることで習慣化を支援する。*

---

### **✦ 瞬間的なフィードバックループ**

- **触覚フィードバック：**カードのスワイプ完了時やボタンタップ時に端末を微振動させ、操作が確かに受け入れられた実感を与える。
- **サウンドフィードバック：**正解・不正解時やリワード表示時に短い効果音を再生し、聴覚からも楽しさを演出する。
- **マイクロリワード：**1セットの学習完了時など、区切りの良いタイミングでLottieによる短いアニメーションを表示する。瞬間的な達成感を与え、次の行動への意欲を喚起する。

---

### **✦ 継続を促す仕組み**

- **ストリーク機能：**学習継続を可視化する最重要機能。1日1単語でも学習すれば継続とみなし、継続のハードルを極限まで低く設定する。
- **キャラクターによるエンゲージメント：**ブランドキャラクター「うさぎ」が、ユーザーの学習継続日数に応じてアニメーションを豊かに変化させる。ユーザーの努力を祝福し、アプリへの愛着を育む。

---

### **✦ 快適な学習環境の演出**

- **ロード画面でのチップス表示：**データの待機時間に学習の豆知識を表示し、待ち時間を有益なものに変える。
- **状態に応じたUI表示（エンプティステート/スケルトンローダー）：**データが空の状態では次に行うべき操作を案内し、読み込み中には体感速度を上げるためのスケルトンUIを表示するなど、あらゆる状況でユーザーを迷わせない。

---

### **✦ ユーザーエンゲージメント戦略**

- **プッシュ通知による動機付け**：学習リマインダーやストリーク継続の支援を目的として、ユーザーの許可を得た上でプッシュ通知を活用する。ただし、通知は学習体験を阻害しないよう、その目的、頻度、タイミングをユーザー自身が細かく設定できるものとする。通知疲れを防ぐため、デフォルト設定はOFF、または最小限（例：学習を3日間休んだら通知）とし、オンボーディングでユーザーに設定を促す。
- **ホーム画面ウィジェットによる学習の日常化**：アプリを起動せずとも、スマートフォンのホーム画面から学習状況の確認やアクションを行えるウィジェットを提供する。
    
    ```yaml
    - ストリークウィジェット
    - 今日の単語ウィジェット
    - 学習ヒートマップ
    ```
    

---

### **✦ 主要インタラクション定義**

```yaml
--------------------------------

WORKFROW: "物理追従型カードスワイプ"
    name: 物理追従型カードスワイプ (Physics-Based Card Swipe)
    description: ユーザーの指の動きにカードが物理的に追従し、直感的で心地よい操作感を提供するインタラクションである。
    workflow:
      --------------------------------
      - step: プレス (Press)
        details: ユーザーがカードに指を置いた瞬間、カードが僅かに浮き上がり、影が濃くなることで、操作対象として認識されたことをフィードバックする。
      --------------------------------
      - step: ドラッグ (Drag)
        details: 指をスライドさせると、カードは指の動きに完全に追従し、位置と傾きがリアルタイムに変化する。これにより『カードが手に張り付いている』感覚を生む。左右にドラッグすると、カードの下から『わかる』『わからない』といったフィードバックが徐々に現れ、アクションの結果を予見させる。
      --------------------------------
      - step: リリース (Release)
        details: 指を画面から離した瞬間、移動距離に基づきアクションが実行される。
        conditions:
          - condition: 移動距離が閾値未満 (Snap-back)
            result: カードは元の位置に滑らかにアニメーションして戻る。
          - condition: 移動距離が閾値以上 (Fly-away)
            result: ドラッグした方向に対応したアクションが実行され、カードはその方向へ画面外に飛んでいくアニメーションと共に処理される。

--------------------------------

WORKFROW: "パンチアクション"
    name: パンチアクション (Punch Action)
    description: カードを裏返すことなく、一つの表面上で完結する解答表示インタラクションであり、認知負荷と操作コストの最小化を目的とする。
    workflow:
      --------------------------------
      - step: 初期状態
        details: カード内の解答エリアは、視覚的に隠蔽されている。これにより、ユーザーは意図せず答えを見てしまうことがない。
      --------------------------------
      - step: アクション
        details: ユーザーが解答エリアを一度タップするだけの単純な操作。
      --------------------------------
      - step: 結果
        details: タップされた瞬間、隠されていた解答が小気味よいマイクロインタラクション（例: 僅かな拡大と振動）と共に瞬時に表示される。思考を中断させない、即時的なフィードバックを提供する。
      --------------------------------
```

---

## ***【 usalingo_03_04｜サイトマップ  】***

---

### **● サイトマップ**

```html
usalingoアプリ
└── ログイン/サインアップ後
    └── メイン画面
        └── ボトムナビゲーション
            ├── 🔴 学習タブ (Home)
            │   └── 🟡 ウィジェットエリア
            │       ├── 配置済みウィジェット (例: 学習デッキ)
            │       │   ├── ウィジェットタップ ──> 学習画面 (フラッシュカード, 4択クイズ等)
            │       │   └── 編集アイコンタップ ──> 学習設定ボトムシート
            │       │       ├── 学習スタイル選択
            │       │       ├── 出題範囲設定
            │       │       └── セッション設定
            │       └── プレースホルダー (空きスロット)
            │           └── タップ ──> ウィジェットギャラリー (学習デッキ追加)
            │
            ├── 🔴 デザインカスタマイズタブ (Design)
            │   └── 🟡 設定項目
            │       ├── UIテーマ設定モジュール
            │       ├── カードUI設定モジュール
            │       ├── アプリ挙動設定モジュール
            │       └── アプリアイコン変更モジュール
            │
            └── 🔴 プロフィールタブ (Profile)
                └── 🟡 ウィジェットエリア
                    ├── ストリークウィジェット
                    ├── 学習ヒートマップウィジェット
                    ├── 実績サマリーウィジェット
                    ├── 簡易プロフィールウィジェット
                    │   └── タップ ──> アカウント設定画面 (メアド, PW, プラン変更)
                    ├── アプリロゴウィジェット
                    │   └── タップ ──> 補助機能画面 (規約, ヘルプ, プラン詳細)
                    └── プレースホルダー (空きスロット)
                        └── タップ ──> 2ウィジェットギャラリー (プロフィールウィジェット追加)
```

---

## ***【 usalingo_03_05｜チュートリアル設計 】***

*本セクションでは、新規ユーザーがアプリ起動直後に体験する、インタラクティブ・チュートリアルの仕様を定義する。目的は、アカウント登録や複雑な設定の前に、本アプリのコア価値である「物理追従型カードスワイプの心地よさ」を直感的に、そして最も魅力的な形で体験してもらうことにある。*

---

### **● 基本思想と目的**

- **体験ファースト：**機能説明を読ませるのではなく、実際に触って「楽しい」「気持ちいい」と感じてもらうことを最優先する。
- **成功体験の演出：**ユーザーが迷うことなく、必ず「わかる」を体験できるように設計する。
- **認知負荷の最小化：**UI上のテキストやボタンは極限まで減らし、ユーザーの意識がカードの動きそのものに集中するように導く。

---

### **● チュートリアル・フロー**

| ステップ | 画面上の状態 | ユーザーのアクション | システムの反応とフィードバック |
| --- | --- | --- | --- |
| **1. 導入** | 画面中央に1枚のカード。「"Welcome"」と表示されている。 | （特になし） | カードが少しだけ上下に揺れ、触ってみるように促すアニメーション。 |
| **2. プレス体験** | - | カードを長押しする。 | カードが僅かに浮き上がり、影が濃くなる。触覚フィードバック（弱）。（`interaction-swipe`の`press`を体験） |
| **3. ドラッグ体験** | カードの左右に「わかる」「わからない」のインジケーターがうっすら表示される。 | カードを左右にドラッグする。 | 指の動きにカードが追従し、傾く。インジケーターの透明度が変化する。（`interaction-swipe`の`drag`を体験） |
| **4. リリース体験** | - | カードを右方向（わかる）に大きくスワイプし、指を離す。 | カードが画面外へ飛んでいく（Fly-away）。「正解」を意味する短い効果音とLottieアニメーションが表示される。 |
| **5. 完了** | 「"Let's get started!"」というメッセージと、「次へ」ボタンが表示される。 | 「次へ」ボタンをタップする。 | チュートリアルが完了し、`usalingo_03_04`で定義されたユーザーフローの次のステップ（オンボーディングアンケート）へ遷移する。 |

---

### **● チュートリアル用コンテンツ（仮）**

*チュートリアルで使用する単語は、誰もが知っている簡単な単語に限定し、ユーザーが意味の判断に迷うことなく、スワイプ操作そのものに集中できるようにする。*

```yaml
# チュートリアル用単語リスト（例）
- word: "Welcome"
- word: "Rabbit"
- word: "Apple"
```

---

### **● ユーザーフロー（オンボーディング〜初回学習）**

```yaml
user_flow:
  name: "新規ゲストユーザーの初回学習体験フロー"
  steps:
    - step: 1
      action: アプリ初回起動
      result: スプラッシュスクリーン表示後、インタラクティブ・チュートリアルが開始される
      
    - step: 2
      action: インタラクティブ・チュートリアルを完了
      result: カードスワイプの基本操作と楽しさを習得する
      
    - step: 3
      action: オンボーディングアンケートに回答
      result: ユーザーの学習目的を特定し、最適な初期デッキが自動設定される
      
    - step: 4
      action: メイン画面へ遷移
      result: すぐに学習を開始できる状態で学習タブが表示される（ゲストモード）
     
    # --- Step 2: ユーザー主体の自由探索フェーズ ---
    - type: "boundary"
      description: "--- ▼ ここからはユーザーの自由行動 ---"
     
    - step: 5
      action: 学習デッキウィジェットをタップ
      result: 最初の学習セッションが開始される
      
    - step: 6
      action: 1セットの学習を完了
      result: マイクロリワードが表示され、達成感を演出する
      
    - step: 7
      action: アカウント登録を促すボトムシートが表示される
      result: 学習進捗の保存をメリットとして提示し、任意のアカウント登録へ誘導する
```

---

</aside>

$$
\color{FF5D97}\rule{400px}{10px}
$$

<aside>
<img src="https://www.notion.so/icons/wheat_gray.svg" alt="https://www.notion.so/icons/wheat_gray.svg" width="40px" />

# *【 usalingo_04_technical_requirements.md 】*

*プロダクトを「どう作るか (How to build)」を定義する。技術的な実装の設計図。*

---

## ***【 usalingo_04_01｜開発環境 & 技術スタック 】***

<aside>

**● ハードウェア環境**

| 開発マシン | MacBook Air (15-inch, M2, 2023)
**チップ**: Apple M2
**メモリ**: 16 GB
**OS**: macOS Sequoia 15.6 |
| --- | --- |
| テスト用実機 | iPhone 12 (64GB) |

---

**● ソフトウェア環境**

[https://github.com/uiui-1028/usalingo_app_flutter](https://github.com/uiui-1028/usalingo_app_flutter)

| IDE | Cursur AI Editer (VS Codeベース) |
| --- | --- |
| 言語／フレーム | Flutter (Dart) |
| AIエージェント | Claude Code, Gemini CLI |
| バージョン管理 | Git / GitHub |
| CI／CD | GitHub Actions |
| デザイン | Figma, Canva, iconComposer, ibisPaint |
| プロジェクト管理 | Notion, Gemini, Claude, Cursur, GoogleWorkspace |

---

**● クラウド環境**

| BaaS | Supabase |
| --- | --- |
| データベース | Supabase Database (PostgreSQL) |
| 認証 | Supabase Auth |
| ストレージ | Supabase Storage (画像・音声) |
| アセット調達 | LottieFiles Marketplace |

---

**● Flutter ライブラリ／パッケージング** *⚠️ 保留*

</aside>

---

## ***【 usalingo_04_02｜ディレクトリツリー 】***

<aside>

```yaml
# 【 03-04｜リポジトリ構成 】
usalingo_app/
├── .git/                    # Gitリポジトリの管理ファイル
├── .dart_tool/              # Dartツールのキャッシュと設定
├── .idea/                   # IntelliJ IDEAの設定ファイル
├── build/                   # ビルド出力ディレクトリ
├── lib/                     # メインのDartソースコード
│   ├── app/                 # アプリケーションの初期化とDI設定
│   │   ├── app.dart         # アプリケーションのメイン設定
│   │   └── providers.dart   # 依存性注入のプロバイダー設定
│   ├── data/                # データ層（Clean Architecture）
│   │   ├── datasources/     # データソース（Supabase、SQLite等）
│   │   │   ├── learning_progress_datasource.dart  # 学習進捗データソース
│   │   │   ├── local_word_datasource.dart         # ローカル単語データソース
│   │   │   └── sqlite_schema.dart                 # SQLiteスキーマ定義
│   │   ├── models/          # データ転送オブジェクト（DTO）
│   │   └── repositories/    # リポジトリの実装
│   │       ├── learning_progress_repository_impl.dart  # 学習進捗リポジトリ実装
│   │       ├── word_repository_impl.dart              # 単語リポジトリ実装
│   │       ├── word_repository_selector.dart          # リポジトリ選択ロジック
│   │       ├── word_repository_sqlite.dart            # SQLite単語リポジトリ
│   │       └── word_repository_supabase.dart          # Supabase単語リポジトリ
│   ├── domain/              # ドメイン層（Clean Architecture）
│   │   ├── entities/        # ビジネスエンティティ
│   │   │   ├── learning_progress.dart  # 学習進捗エンティティ
│   │   │   └── word.dart               # 単語エンティティ
│   │   ├── repositories/    # リポジトリのインターフェース
│   │   └── usecases/       # ビジネスロジック（ユースケース）
│   │       ├── get_due_today_cards.dart      # 今日学習すべきカード取得
│   │       ├── get_learning_progress.dart    # 学習進捗取得
│   │       ├── get_next_word.dart            # 次の単語取得
│   │       └── mark_card_result.dart         # カード結果記録
│   ├── presentation/        # プレゼンテーション層（Clean Architecture）
│   │   ├── pages/          # 画面UIと状態管理
│   │   │   ├── flashcard_page.dart              # フラッシュカード画面
│   │   │   ├── learning_progress_test_page.dart # 学習進捗テスト画面
│   │   │   ├── root_page.dart                   # ルート画面
│   │   │   ├── supabase_test_page.dart          # Supabaseテスト画面
│   │   │   ├── test_3d_card_screen.dart         # 3Dカードテスト画面
│   │   │   ├── theme_selector_page.dart         # テーマ選択画面
│   │   │   └── word_list_page.dart              # 単語リスト画面
│   │   ├── theme/          # テーマ設定
│   │   │   ├── app_theme.dart                   # アプリテーマ設定
│   │   │   ├── app_theme_provider.dart          # テーマプロバイダー
│   │   │   └── themes/                          # 各テーマの実装
│   │   │       ├── flat_theme.dart              # フラットテーマ
│   │   │       ├── material_theme.dart          # Materialテーマ
│   │   │       ├── mockup_theme.dart            # モックアップテーマ
│   │   │       ├── neumorphism_theme.dart       # ニューモーフィズムテーマ
│   │   │       ├── pixel_art_theme.dart         # ピクセルアートテーマ
│   │   │       └── wireframe_theme.dart         # ワイヤーフレームテーマ
│   │   └── widgets/        # 再利用可能なウィジェット
│   │       ├── flashcard_widget.dart            # フラッシュカードウィジェット
│   │       └── lottie_feedback_widget.dart      # Lottieフィードバックウィジェット
│   ├── main.dart           # アプリケーションのエントリーポイント
│   └── secrets.dart        # 機密情報（APIキー等）
├── docs/                     # メインのDartソースコード
│   ├── README.md                  # ドキュメント全体の概要
│   ├── rules/                     # 開発ルール（既存）
│   │   ├── README.md
│   │   ├── common-rules.md        # Cursor AI Editor用のルール
│   │   ├── cursor-rules.md        # Claude用のルール
│   │   └── claude-rules.md        # 共通ルール（重複部分）
│   ├── architecture/              # アーキテクチャ設計
│   │   └── overview.md            # システム設計概要
│   ├── development/               # 開発ガイド
│   │   └── setup.md               # 開発環境セットアップ
│   ├── features/                  # 機能仕様書
│   │   └── flashcard-system.md    # フラッシュカード機能
│   └── troubleshooting/           # トラブルシューティング
│       └── common-issues.md       # よくある問題と解決方法
├── assets/                 # 静的アセット
│   ├── audio/              # 音声ファイル
│   └── lottie/             # Lottieアニメーションファイル
├── android/                # Androidプラットフォーム固有のファイル
├── ios/                    # iOSプラットフォーム固有のファイル
├── linux/                  # Linuxプラットフォーム固有のファイル
├── macos/                  # macOSプラットフォーム固有のファイル
├── windows/                # Windowsプラットフォーム固有のファイル
├── web/                    # Webプラットフォーム固有のファイル
├── test/                   # テストコード
├── .DS_Store               # macOSシステムファイル
├── .flutter-plugins-dependencies # Flutterプラグイン依存関係
├── .gitignore              # Git除外設定
├── .metadata               # Flutterメタデータ
├── analysis_options.yaml    # Dart解析設定
├── devtools_options.yaml   # Flutter DevTools設定
├── pubspec.lock            # 依存関係ロックファイル
├── pubspec.yaml            # プロジェクト設定と依存関係
├── README.md               # プロジェクト概要
└── usalingo_app.iml       # IntelliJ IDEAプロジェクト設定
```

</aside>

---

## ***【 usalingo_04_03｜データベース設計 】***

<aside>

### ✦ 設計原則

---

### ● **命名規則**

- **基本:** 半角英小文字のスネークケース (`snake_case`) のみを使用する。日本語、スペース、その他の特殊文字は使用しない。これにより、URLエンコーディングやクエリでの問題を回避する。
- **テーブル:** 複数のデータを格納するため、**複数形** (`users`, `words`, `user_settings`) を使用する。
- **カラム:** 単一の属性を表すため、**単数形** (`email`, `word_text`, `created_at`) を使用する。
- **主キー (PK):** カラム名を `id` とする。
- **外部キー (FK):** `[参照先テーブルの単数形]_id` という形式（例: `user_id`, `word_id`）を採用する。
- **タイムスタンプ:** 作成日時を `created_at`、更新日時を `updated_at` とする。
- **真偽値:** `is_` プレフィックスを使用する（例: `is_public`, `is_completed`）。

### ● **アセット管理方針**

- **単一マスターイメージの原則:** ストレージには高解像度のオリジナル画像を1つだけ保存する。
- **動的変換の活用:** 画像の配信には、Supabaseの**「Storage Image Transformation」**機能を全面的に活用する。URLのクエリパラメータ（例: `?transform=width=200`）で、表示箇所に応じた最適なサイズの画像を動的に生成・配信する。これにより、開発効率とパフォーマンスを最大化する。
- **ファイル命名:** `[単語テキスト]_[タイプ].[拡張子]` (例: `apple_illustration.webp`) の形式で、内容が推測できるファイル名とする。

---

### ✦ セキュリティ方針（RLS）

*アクセスは原則として全て拒否し、これから定義するポリシーで許可された操作のみを可能とします。これにより、意図しないデータ漏洩のリスクを最小限に抑えます。*

---

### ● **ポリシー定義**

- **公開データ (Public Data):**
    - **対象テーブル:** `words`, `example_contents`, `decks`
    - **ポリシー:** **全てのユーザー（非認証ユーザーを含む）が読み取り (`SELECT`) 可能。** 書き込み（`INSERT`, `UPDATE`, `DELETE`）は全てのユーザーに対して不可とする。
- **認証ユーザー共通データ (Authenticated User Data):**
    - **対象テーブル:** `users`
    - **ポリシー:** **認証済みのユーザーは、自身のユーザー情報のみ読み取り可能。** 他のユーザーの情報は読み取れない。
- **所有権に基づくデータ (Ownership-based Data):**
    - **対象テーブル:** `user_profiles`, `user_settings`, `user_learning_progress`, `user_widget_layouts`
    - **ポリシー:** **ユーザーは、自身の `user_id` に紐づくデータのみ、全ての操作（`SELECT`, `INSERT`, `UPDATE`, `DELETE`）が可能。**
        - **具体例:** `user_profiles` テーブルを操作しようとする場合、`auth.uid() = user_id` が真となる行にしかアクセスできないようにポリシーを設定します。これはSupabase Authが提供する `auth.users` テーブルと連携することで実現します。

---

### ✦ストレージ戦略

アプリケーションを構成するデータの種類、論理構造、物理的な保存場所を定義する。

---

### 【01】データスタイル定義

| データ種別 | 形式 | 主な用途 |
| --- | --- | --- |
| テキスト | TEXT / String | 単語、例文、UI上の文言など |
| 画像 | WEBP / PNG | 単語に紐づくイラスト、UIアイコンなど (※WEBPを優先し軽量化) |
| 音声 | MP3 | 単語・例文の読み上げ音声 |
| Lottie | JSON | UIアニメーション、マイクロインタラクション、学習完了時のリワードなど |

---

### 【02】データベース俯瞰図 (論理構造)

| テーブル名 | 概要 | ストレージ | 主なカラム |
| --- | --- | --- | --- |
| users | ユーザーアカウント情報 | Supabase | user_id, email, created_at |
| user_learning_progress | ユーザーごとの学習進捗と忘却曲線データ | Supabase & SQLite | id, user_id, content_id, last_reviewed, next_review_date, correct_count |
| contents | 単語や例文などのコアコンテンツ（テキスト情報） | Supabase & SQLite | content_id, word, example_sentence |
| content_assets | コンテンツに紐づくアセット（画像・音声）のパスを管理 | Supabase | asset_id, content_id, asset_type, storage_path |
| chips_data | アプリ内で使用する静的なTipsなどの情報 | SQLite | chip_id, title, description |

---

### 【03】ストレージ俯瞰図 (物理構造)

| 格納データ | ストレージ名 | 概要 |
| --- | --- | --- |
| 上記 users や contents などのテーブルデータ | Supabase Database | 構造化されたメタデータ。リレーショナルな関係性を持ち、クエリで操作される。 |
| 画像ファイル (.webp), 音声ファイル (.mp3) | Supabase Storage | コンテンツに紐づくバイナリファイル。DBからはパスで参照する。 |
| chips_data テーブル | SQLite | 頻繁な更新が不要で、オフラインでも利用したい静的な構造化データ。 |
| Lottieファイル (.json), UI用画像 | App Asset Bundle | アプリに同梱する静的アセット。UIのアニメーションなど、高速な表示が求められるもの。 |

---

### 【04】ストレージの定義

```yaml
storage_positions:
  - type: "クラウドストレージ"
    service: "Supabase"
    description: "動的に変化し、かつ複数のデバイス間で同期が必要なデータに適している。ユーザーがどのデバイスからアクセスしても、同じ学習環境を提供できる。"
    use_cases:
      - "ユーザー学習データ"
      - "コンテンツマスター"

  - type: "ローカルストレージ"
    service: "SQLite"
    description: "配布後は変更の頻度が低く、オフラインでの利用が想定される静的コンテンツに適している。アプリケーションに組み込むことで、通信環境に依存しない高速なデータアクセスが可能になる。"
    use_cases:
      - "チップスデータ"
      - "Lottieファイル"
```

---

### ✦ テーブル定義

*本ドキュメントは、usalingo アプリケーションの根幹をなす Supabase (PostgreSQL) データベースの論理設計を定義する。*

---

### ユーザー関連 (User & Profile)

```yaml
# -----------------------------------------------
# Table: users (Supabase Authと同期)
# -----------------------------------------------
- table: users
  description: "Supabaseの認証機能と1対1で対応する、ユーザーの基本認証情報。このテーブルへの直接的な書き込みはAuth経由で行われる。"
  columns:
    - name: id
      type: UUID (Primary Key)
      description: "Supabase Authによって自動的に割り当てられる、ユーザーの一意なID。"
    - name: email
      type: TEXT
      description: "ユーザーのメールアドレス。"
    - name: created_at
      type: TIMESTAMPTZ
      description: "アカウントの作成日時。"

# -----------------------------------------------
# Table: user_profiles
# -----------------------------------------------
- table: user_profiles
  description: "ユーザーのプランやニックネームなど、付加的なプロフィール情報を格納する。"
  columns:
    - name: user_id
      type: UUID (Primary Key, Foreign Key to users.id)
      description: "ユーザーID。usersテーブルとのリレーションを確立する。"
    - name: plan
      type: TEXT (default: 'free')
      description: "ユーザーの現在のプラン ('free' or 'pro') 。"
    - name: nickname
      type: TEXT
      description: "アプリ内で表示されるユーザーの名前。"

# -----------------------------------------------
# Table: user_settings
# -----------------------------------------------
- table: user_settings
  description: "UIテーマ、フォント、音声など、ユーザーがカスタマイズしたアプリの表示・挙動設定を管理する。"
  columns:
    - name: user_id
      type: UUID (Primary Key, Foreign Key to users.id)
      description: "ユーザーID。"
    - name: design_style
      type: TEXT (default: 'flat_design')
      description: "UIの基本スタイル (例: 'flat_design', 'neumorphism') 。"
    - name: color_mode
      type: TEXT (default: 'system')
      description: "カラーモード ('light', 'dark', 'system') 。"
    - name: accent_color
      type: TEXT (default: '#FF5D97')
      description: "アクセントカラーのHEXコード。"
    - name: font_family
      type: TEXT (default: 'system_default')
      description: "アプリ全体のフォントファミリー名。"
    - name: card_interaction_mode
      type: TEXT (default: 'punch')
      description: "解答インタラクション ('punch' or 'flip') 。"
    - name: tts_config
      type: JSONB
      description: "Text-to-Speechの音声（性別、速度など）に関する設定を格納する。"

# -----------------------------------------------
# Table: user_widget_layouts
# -----------------------------------------------
- table: user_widget_layouts
  description: "ユーザーが「学習」「プロフィール」の各タブに配置したウィジェットのレイアウト情報を管理する。"
  columns:
    - name: id
      type: SERIAL (Primary Key)
      description: "レイアウト情報の一意なID。"
    - name: user_id
      type: UUID (Foreign Key to users.id)
      description: "このレイアウトを所有するユーザーID。"
    - name: tab_name
      type: TEXT
      description: "ウィジェットが配置されているタブ名 ('learning' or 'profile') 。"
    - name: widget_type
      type: TEXT
      description: "ウィジェットの種類 (例: 'deck', 'streak', 'heatmap') 。"
    - name: related_id
      type: INT
      description: "ウィジェットのマスターデータへの参照ID。widget_typeが'deck'の場合は、decks.idを指す。"
    - name: display_order
      type: INT
      description: "タブ内での表示順序。"
    - name: settings
      type: JSONB
      description: "ウィジェット固有の設定（例：学習デッキの出題範囲やスタイル）を格納する。"
```

---

### コンテンツ関連 (Content & Deck)

```yaml
# -----------------------------------------------
# Table: words
# -----------------------------------------------
- table: words
  description: "全ての英単語の基本情報を格納するマスターテーブル。「ワードファミリー」の基幹となる単語を登録する。"
  columns:
    - name: id
      type: SERIAL (Primary Key)
      description: "単語の一意なID。"
    - name: word_text
      type: TEXT (UNIQUE)
      description: "英単語の文字列。"
    - name: definition
      type: TEXT
      description: "単語の主要な日本語訳。"
    - name: part_of_speech
      type: TEXT
      description: "品詞。"
    - name: etymology
      type: TEXT
      description: "語源の解説。"
    - name: synonyms
      type: TEXT[]
      description: "類義語のリストを配列で格納する。"
    - name: antonyms
      type: TEXT[]
      description: "対義語のリストを配列で格納する。"

# -----------------------------------------------
# Table: example_contents
# -----------------------------------------------
- table: example_contents
  description: "一つの単語に対して、テーマ（シンプル、ツンデレ等）ごとに存在する例文、イラスト、音声を管理する。"
  columns:
    - name: id
      type: SERIAL (Primary Key)
      description: "コンテンツセットの一意なID。"
    - name: word_id
      type: INT (Foreign Key to words.id)
      description: "関連する単語のID。"
    - name: theme
      type: TEXT (default: 'simple')
      description: "コンテンツのテーマ ('simple', 'tsundere', 'animal'など) 。"
    - name: sentence_en
      type: TEXT
      description: "英語の例文。"
    - name: sentence_ja
      type: TEXT
      description: "例文の日本語訳。"
    - name: illustration_url
      type: TEXT
      description: "例文イラスト画像のURL (Supabase Storage) 。"
    - name: audio_url
      type: TEXT
      description: "例文読み上げ音声のURL (Supabase Storage) 。"

# -----------------------------------------------
# Table: decks
# -----------------------------------------------
- table: decks
  description: "NGSLやTSLといった、学習デッキのマスターデータを定義する。"
  columns:
    - name: id
      type: SERIAL (Primary Key)
      description: "デッキの一意なID。"
    - name: deck_name
      type: TEXT (UNIQUE)
      description: "デッキの名称 (例: 'NGSL - 基礎単語') 。"
    - name: description
      type: TEXT
      description: "デッキの内容に関する詳細な説明。"
    - name: source_list_name
      type: TEXT
      description: "参照元の単語リスト名 (例: 'NGSL', 'TSL') 。"
    - name: license
      type: TEXT
      description: "コンテンツのライセンス情報 (例: 'CC BY-SA 4.0') 。"

# -----------------------------------------------
# Table: deck_words
# -----------------------------------------------
- table: deck_words
  description: "どのデッキにどの単語が含まれるか、多対多の関係を定義する中間テーブル。"
  columns:
    - name: deck_id
      type: INT (Primary Key, Foreign Key to decks.id)
      description: "デッキID。"
    - name: word_id
      type: INT (Primary Key, Foreign Key to words.id)
      description: "単語ID。"
```

---

### 学習進捗関連 (Learning Progress)

```yaml
# -----------------------------------------------
# Table: user_learning_progress
# -----------------------------------------------
- table: user_learning_progress
  description: "ユーザーごとの単語学習進捗。忘却曲線アルゴリズムのパラメータもここで管理する。"
  columns:
    - name: user_id
      type: UUID (Primary Key, Foreign Key to users.id)
      description: "ユーザーID。"
    - name: word_id
      type: INT (Primary Key, Foreign Key to words.id)
      description: "学習対象の単語ID。"
    - name: status
      type: TEXT (default: 'new')
      description: "学習ステータス ('new', 'learning', 'mastered') 。"
    - name: last_reviewed_at
      type: TIMESTAMPTZ
      description: "最後にこの単語を復習した日時。"
    - name: next_review_date
      type: TIMESTAMPTZ
      description: "アルゴリズムによって算出された、次回復習推奨日時。"
    - name: srs_level
      type: INT (default: 1)
      description: "リートナー方式における現在のレベル。"
    - name: easiness_factor
      type: REAL (default: 2.5)
      description: "SM-2アルゴリズムにおける易しさ係数（E-Factor）。"
    - name: repetitions
      type: INT (default: 0)
      description: "SM-2アルゴリズムにおける連続正解回数。"
    - name: interval_days
      type: INT (default: 0)
      description: "SM-2アルゴリズムにおける前回の復習間隔。"
```

</aside>

---

## ***【 usalingo_04_04｜アルゴリズム設計 】***

### 【01】忘却曲線 アルゴリズム（ リートナー方式 ）

 *MVP段階では、オフライン学習機能テストとコスト削減のため、ユーザー端末のローカルDB（SQLite）で管理する**リートナー方式**を採用する。*

---

**● データモデル（ローカルDB｜SQLite）**

| カラム名 | 型 | 説明 |
| --- | --- | --- |
| word_id | INTEGER | どの単語の進捗かを示す一意な ID |
| srs_level | INTEGER | リートナー方式のレベル（1〜5）, 数値が高いほど定着している状態を示す |
| next_review_date | TEXT | 次回復習日を YYYY-MM-DDTHH:MM:SS 形式の文字列で格納 |

---

**● アルゴリズム仕様**

```yaml
# ===============================================
# Algorithm Spec: Leitner System (MVP)
# ===============================================

# -----------------------------------------------
# 1. 復習間隔の定義 (SRS Levels)
# -----------------------------------------------
- level: 1
  interval_days: 1
  description: "「わからない」と評価されたカードが属する初期レベル"
- level: 2
  interval_days: 3
- level: 3
  interval_days: 7
- level: 4
  interval_days: 14
- level: 5
  interval_days: 30
  description: "このレベルをクリアすると「マスター済み」と見なす"

# -----------------------------------------------
# 2. ロジックフロー
# -----------------------------------------------
- event: "カードを「わかる」にスワイプ"
  action:
    - "srs_level を 1つ進める (例: level 2 -> level 3)。"
    - "進んだ先のレベルに対応する interval_days を現在日時に加算し、next_review_date を更新する"

- event: "カードを「わからない」にスワイプ"
  action:
    - "srs_level を 1 にリセットする。"
    - "レベル1の interval_days を現在日時に加算し、next_review_date を更新する"

# -----------------------------------------------
# 3. データ同期方針
# -----------------------------------------------
- primary_storage: "ユーザー端末内のローカルDB (SQLite)"
  description: "オフラインでの軽快な動作を保証する"
```

---

### 【02】忘却曲線 アルゴリズム（ SM-2 ）

 *本来は4択でグラデーションを持って計量するところを, 2択のシンプルなUIUXで独自に再編成した、SM-2のパーソナライズ機能を一部取り入れたハイブリッド方式。*

---

**● データモデル（ローカルDB｜SQLite）**

| カラム名 | 型 | 説明 |
| --- | --- | --- |
| word_id | INTEGER | どの単語の進捗かを示す一意なID。 |
| easiness_factor | REAL | 易しさ係数（E-Factor）。初期値は2.5。 |
| repetitions | INTEGER | 連続正解回数。不正解で0にリセットされる。 |
| interval_days | INTEGER | 前回の復習間隔（日数）。 |
| next_review_date | TEXT | 次回復習日。 |

---

**● アルゴリズム仕様**

```yaml
# ===============================================
# Algorithm Spec: 2-Choice SM-2 (Hybrid)
# ===============================================

# -----------------------------------------------
# 1. ユーザー入力の定義
# -----------------------------------------------
# ユーザーの操作は「わかる」「わからない」の2択のみ。
- event: "カードを「わかる」にスワイプ"
  is_correct: true

- event: "カードを「わからない」にスワイプ"
  is_correct: false

# -----------------------------------------------
# 2. ロジックフロー
# -----------------------------------------------
- event: "is_correct が false の場合"
  action:
    - "repetitions を 0 にリセットする。"
    - "interval_days を 1 にリセットする。"
    - "easiness_factor を 0.2 減少させる（下限は1.3）。"

- event: "is_correct が true の場合"
  action:
    - "repetitions を 1つ進める。"
    - "easiness_factor は変更しない（または僅かに増加させる）。"
    - "repetitions の値に応じて interval_days を計算・更新する。"
    - "  - 1回目: 1日"
    - "  - 2回目: 6日"
    - "  - 3回目以降: 前回のinterval_days * easiness_factor"
    - "最後に、計算された interval_days を基に next_review_date を更新する。"

# -----------------------------------------------
# 3. データ同期方針
# -----------------------------------------------
- primary_storage: "ユーザー端末内のローカルDB (SQLite)"
- secondary_storage: "クラウドDB (Supabase)"
- sync_trigger: "定期的、または手動でのバックアップと復元。"
```

---

### 【03】学習履歴に基づく動的コンテンツ生成

### **✦ AIによる学習コンテンツ生成機能の詳細**

「AIによる学習コンテンツ生成」は、Proプラン限定の機能である。ユーザーがこれまでに学習した単語の中から、AIが自動で複数の単語をピックアップし、それらを用いてリアルタイムでユニークな例文（英文＋和訳）を生成する。これにより、ユーザーは自身の学習履歴に基づいた文脈で単語を復習でき、記憶の定着を促進する。本機能の優先度は「P3（中長期的な改善・追加機能）」と位置づけられる。例えば、学習した単語が予期せぬ組み合わせで文章に登場することにより、ユーザーは自身の理解度を多角的に試すことができる。

### **✦ 技術的な仕様**

技術的には、OpenAI（GPTシリーズ）またはGoogle（Geminiシリーズ）のAIモデルを利用する。APIキーを安全に管理するため、アプリから直接AIを呼び出すのではなく、SupabaseのEdge Functionsを介してリクエストを中継する。データの品質を保つため、AIへの指示はあらかじめ定義されたテンプレートを使用し、常にJSON形式でデータをやり取りする。

```yaml
1. ユーザーがアプリで例文生成をリクエストする。
2. アプリはSupabase Edge Functionにリクエストを送信する。
3. Edge Functionは、ユーザーの学習進捗データ（user_learning_progress）を参照し、復習対象となる単語を複数抽出する。
4. Edge Functionが抽出した単語群と、任意で指定された文脈テーマを基に、AIモデルへ最適な指示（プロンプト）を組み立て、例文の生成をリクエストする。
5. AIが生成した例文のデータをEdge Functionが受け取る。
6. Edge Functionがデータを整形し、安全にアプリへ返す。
7. アプリが受け取った例文を画面に表示する。
```

### **✦ ユーザー体験の流れ**

ユーザーは学習タブに配置できる「AI例文生成ウィジェット」からこの機能を使う。ウィジェットには、任意で文脈（例：'ビジネス'、'医療'など）を指定する欄が用意される。「例文を生成する」ボタンを押すと、AIが応答するまでの待機時間には、処理中であることが分かるようにローディングアニメーションが表示される。生成された例文は、学習カード形式ではなく、ニュース記事を読むような感覚でスクロールしながら読めるシンプルなテキストビューとして表示される。ここでは「わかる／わからない」といった評価操作は行わず、純粋な読解と復習に集中することができる。APIでエラーが発生した場合は、その旨を分かりやすく伝え、再試行を促する。

### **✦ 機能制約と前提条件**

- **APIコスト**: AIモデルの呼び出しごとに従量課金が発生する。本機能の事業採算性は、Proプランの価格とユーザー一人あたりのAPI利用回数制限のバランスに依存する。
- **応答遅延 (Latency)**: AIの応答には数秒の遅延が内在する。この待機時間がユーザー体験を損なわないよう、適切なUI/UX（ローディング表示等）によるハンドリングを前提とする。
- **品質の不確実性**: AIが不正確、または文脈に合わない不適切な例文を生成するリスクは常に存在する。機能の信頼性は、プロンプトエンジニアリングの継続的な改善によって担保される。
- **ロジック依存性**: 本機能が提供する学習価値は、ユーザーの学習履歴から復習に最適な単語を選び出す、その選定ロジックの精度に直接的に依存する。

---

### 【04】**英語力別のデータパーソナライズ方法**

*本アルゴリズムは、ユーザーがアプリを使い始めた瞬間の体験価値を最大化し、学習離脱率を低減させることを目的とする。*

---

### **✦ 基本思想**

多くのユーザーは、学習を開始する前の「選択」や「登録」といった行為に負荷を感じ、意欲を削がれてしまう。この障壁を取り除くため、アプリ初回起動時にはアカウント登録を要求せず、標準の「ウェルカムデッキ」を自動提供し、即座に学習を開始できる環境を用意する。その後、ユーザーがアカウント登録を行った際には、それまでの学習履歴を失うことなく新しいアカウントへ引き継ぐ。同時に、アンケートに基づきユーザーの目的に合った「パーソナライズドデッキ」を新しいウィジェットとして追加することで、気軽な体験から本格的なパーソナライズ学習へのシームレスな移行を実現する。

---

### **✦ アルゴリズム仕様**

```yaml
# ===============================================
# Algorithm Spec: Initial Content Personalization Strategy (Integrated Ver.)
# ===============================================

# -----------------------------------------------
# 1. フェーズ1：ゲスト体験（アプリ初回起動時）
# -----------------------------------------------
- event: ユーザーがアプリを初めて起動する
- action:
    - 1. ウェルカムデッキの自動配置：約300語を収録した標準のウェルカムデッキを、学習タブのウィジェットエリアに自動で配置する。
    - 2. ゲスト学習の開始：ユーザーはアカウント登録なしで、すぐにウェルカムデッキの学習を開始できる。学習進捗は端末のローカルDB（SQLite）に一時的に保存される。
- result: ユーザーは一切の摩擦なく、即座に学習体験を開始できる。

# -----------------------------------------------
# 2. フェーズ2：パーソナライズ（アカウント登録完了後）
# -----------------------------------------------
- event: ユーザーが新規アカウント登録を正常に完了する
- action:
------------------------------------------
    - 1. 学習履歴の継承：ローカルDBに保存されていたゲスト時の学習進捗（ウェルカムデッキの進捗）を、新しく作成されたユーザーアカウントに紐付け、Supabaseに保存する。
------------------------------------------
    - 2. オンボーディング・アンケートの実施：ユーザーに単一選択式の質問を提示し、学習目的を特定する。
    -   question_text: あなたの主な学習目的を教えてください
    -   options:
          - id: daily_conversation
            label: 日常英会話
          - id: business
            label: ビジネス英会話
          - id: toeic
            label: TOEIC / 英検対策
          - id: exam
            label: 大学受験
          - id: junior_english
            label: 中学・高校の復習
          - id: none
            label: 特に決まっていない
------------------------------------------
    - 3. 最適な学習デッキの追加：アンケートの回答（option.id）に基づき、以下のマッピングルールに従ってパーソナライズドデッキを決定し、学習タブに新しいウィジェットとして追加する。
    -   mapping_rules:
          - if: option.id is 'daily_conversation'
            then: deck_id: 1 (NGSL基礎単語デッキ) をウィジェットとして追加する
          - if: option.id is 'business'
            then: deck_id: 2 (BSLビジネス単語デッキ) をウィジェットとして追加する
          - if: option.id is 'toeic'
            then: deck_id: 3 (TSL TOEIC頻出単語デッキ) をウィジェットとして追加する
          - if: option.id is 'exam' or 'junior_english'
            then: deck_id: 4 (学術基礎単語デッキ) をウィジェットとして追加する
          - if: option.id is 'none'
            then: deck_id: 1 (NGSL基礎単語デッキ) をデフォルトとして追加し、さらにデッキ選択を促すUIを表示する
- result: 学習タブにはウェルカムデッキと新しいパーソナライズドデッキが別々のウィジェットとして共存する。ユーザーは自身の学習履歴を維持したまま、新たな目的の学習へとスムーズに移行できる。
```

---

### 【05】動的UIテーマシステム

*本アルゴリズムは、競争優位性の一つである「適応型パーソナル空間（アダプティブ・スペース）」を実現するための技術的根幹である。中心的な思想は、UIの構造的骨格と、その視覚的表現であるデザイン思想を完全に分離することにある。これにより、UIデザインの拡張性とメンテナンス性を最大化する。*

*本アルゴリズムは、競争優位性の一つである「適応型パーソナル空間（アダプティブ・スペース）」を実現するための技術的根幹である。中心的な思想は、UIの構造的骨格と、その視覚的表現であるデザイン思想を完全に分離することにある。これにより、UIデザインの拡張性とメンテナンス性を最大化する。*

---

### **1. テーマの契約**

全てのデザイン思想が遵守すべき統一のインターフェース、すなわち「契約」として、一つの抽象クラスを定義する。この契約には、アプリケーションのUIを構成するために必要な、全てのデザイン要素をプロパティとして網羅的に宣言する。これにより、どのデザイン思想を実装する際にも考慮すべき要素の漏れを防ぎ、アプリケーション全体の一貫性を保証する。

| カテゴリ | 属性（例） | 説明 |
| --- | --- | --- |
| **色彩** | 背景色, 基本色, アクセントカラー, テキスト色 | アプリ内で使用する全ての色を定義する。 |
| **タイポグラフィ** | 見出し/本文のフォントファミリー, サイズ, ウェイト | 役割に応じたフォントの階層を定義する。 |
| **形状** | 角丸の半径, 境界線のスタイル | コンポーネントの形状に関する規定を定義する。 |
| **エフェクト** | 陰影の付け方, ブラーの強度 | 視覚効果に関する規定を定義する。 |
| **スペーシング**  | 標準マージン, パディング | コンポーネント間の余白に関する値を定義する。 |

---

### **2. テーマの実装規約（提供側）**

「マテリアルデザイン」や「ニューモーフィズム」といった個別のデザイン思想を、原則1で定義した契約を実装する具体的なクラスとして作成する。各クラスは、契約で定められた全てのプロパティに対し、自身のデザイン思想に基づいた具体的な値を設定する必要がある。このルールにより、将来的に新しいデザイン思想を追加したい場合でも、この契約に準拠した新しいクラスファイルを追加するだけで対応が完了し、既存コードへの影響は最小限に抑えられる。

---

### **3. テーマの利用規約（参照側）**

アプリケーションのUIを構築する際、個々のウィジェットは特定の色やフォントサイズといった値を直接コード内に記述しません。その代わり、状態管理システムを通じて、現在ユーザーに選択されているテーマオブジェクトを一元的に受け取る。全てのウィジェットは、この注入されたテーマオブジェクトから「基本色」や「標準の角丸」といった値を参照して自身のスタイルを決定する。これにより、注入するテーマオブジェクトを切り替えるだけで、アプリケーション全体のルックアンドフィールを瞬時に、かつ整合性を保ったまま変更することが可能になる。

---

### **4. ワイヤーフレーム駆動開発**

開発の基本フェーズにおいては、原則2で定義したテーマ実装の一つである「ワイヤーフレームテーマ」をデフォルトで適用する。このテーマは、色彩や装飾的エフェクトを極限まで削ぎ落とし、UIの構造とレイアウトの骨格のみを可視化するものである。このアプローチによって、開発者は視覚的なデザインの細部に気を取られることなく、機能、データの流れ、そしてビジネスロジックの実装といった、より本質的なタスクに集中できる。

---

## ***【 usalingo_04_05｜アセット管理規定 】***

---

**✦ Lottieアセット利用規定**

| 項目 | 仕様 | 備考 |
| --- | --- | --- |
| **アセット調達方針** | MVPおよびVer.1.0段階では、LottieFiles Marketplace等でライセンス購入した汎用アセットを利用する。 | UI/UXの魅力を迅速に高めることを目的とし、独自アセット（キャラクターアニメーション等）の制作は後のフェーズに設定する。 |
| **アセット格納** | 購入したLottieのJSONファイルは、Flutterプロジェクト内の `assets/lottie/` ディレクトリに格納し、アプリパッケージに同梱する。 | これにより、オフライン環境でもアニメーションの表示を保証し、外部からの読み込み遅延を防ぐ。 |
| **ライセンス管理** | プロジェクトルートに `LOTTIE_LICENSES.md` を作成し、購入した全アセットの名称、購入元URL、ライセンス種別を明記する。 | 権利関係を明確化し、ライセンス違反のリスクを回避するための必須要件である。 |
| **将来的な方針** | ブランドキャラクター「うさぎ」の独自アニメーションは、Ver.2.0以降での内製化を計画する。 | 内製した独自アセットも、本規定で定義した格納方法とライセンス管理の規則に準拠して運用する。 |

---

---

</aside>

$$
\color{FF5D97}\rule{400px}{10px}
$$