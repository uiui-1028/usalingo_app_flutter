# Usalingo アーキテクチャ概要

## プロジェクト構造

### 技術スタック
- **フロントエンド**: Flutter 3.8.1
- **状態管理**: Riverpod 2.4.0
- **ローカルDB**: SQLite (sqflite 2.3.0)
- **クラウドDB**: Supabase (supabase_flutter 1.10.8)
- **アニメーション**: Lottie 2.7.0

### アーキテクチャパターン
```
lib/
├── domain/           # ビジネスロジック層
│   ├── entities/     # エンティティ
│   ├── repositories/ # リポジトリインターフェース
│   └── usecases/    # ユースケース
├── data/            # データ層
│   ├── datasources/ # データソース
│   ├── models/      # データモデル
│   └── repositories/ # リポジトリ実装
└── presentation/    # プレゼンテーション層
    ├── pages/       # ページ
    ├── widgets/     # ウィジェット
    └── theme/       # テーマ
```

## データフロー

### 学習データの流れ
1. **ユーザーアクション** → プレゼンテーション層
2. **ユースケース実行** → ドメイン層
3. **リポジトリ呼び出し** → データ層
4. **データソース操作** → SQLite/Supabase
5. **結果の逆流** → プレゼンテーション層

### 同期処理
- SQLite（ローカル）とSupabase（クラウド）の双方向同期
- オフライン対応のためのローカル優先設計
- 競合解決のためのタイムスタンプ管理

## セキュリティ設計

### データ保護
- ユーザーデータの暗号化
- APIキーの安全な管理
- 認証情報の適切な処理

### プライバシー
- 学習データの匿名化
- 最小権限の原則
- データ削除の透明性

## パフォーマンス最適化

### メモリ管理
- 大量データの段階的読み込み
- 画像とアニメーションの最適化
- 不要なウィジェットの適切な破棄

### データベース最適化
- インデックスの適切な設定
- クエリの最適化
- 接続プールの管理 